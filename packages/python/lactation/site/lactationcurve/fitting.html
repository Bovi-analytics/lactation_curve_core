<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>lactationcurve.fitting API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{  --pdoc-accent-color:#053D6F;  --pdoc-accent-color-dark:#073362;}body{  background-color:#F9FBFD;  font-family:"Helvetica Neue", Arial, sans-serif;  line-height:1.6;  color:#222;}h1{  font-family:"Helvetica Neue", Arial, sans-serif;  color:#053D6F;  font-weight:600;}h2,h3{  color:#053D6F;  font-weight:500;}h1{  border-bottom:2px solid #37B7EA;  padding-bottom:0.3em;}a{  color:#053D6F;  text-decoration:none;}a:hover{  color:#073362;  text-decoration:underline;}code{  background-color:#EDF4FA;  padding:2px 6px;  border-radius:4px;}pre{  background-color:#EDF4FA;  border-left:4px solid #37B7EA;  padding:1em;  border-radius:6px;  overflow-x:auto;}nav{  background-color:#FFFFFF;  border-right:1px solid #E2E8F0;}footer{  border-top:1px solid #E2E8F0;  color:#3C80A9;  font-size:0.9em;}.pdoc .attr.function>.name{  font-weight:600;  font-size:1.1em;  color:var(--pdoc-accent-color);}.pdoc .attr.function{  margin-top:1.8em;  padding-left:1em;  border-left:4px solid #37B7EA;}.pdoc .attr.function .signature{  color:var(--pdoc-accent-color-dark);}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../lactationcurve.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lactationcurve</a>

<a href="https://bovi-analytics.org">            <img src="C:/Users/Meike van Leerdam/lactation_curve_core/packages/python/lactation/site/logo.png" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#ali_schaeffer_model">ali_schaeffer_model</a>
            </li>
            <li>
                    <a class="function" href="#bayesian_fit_milkbot_single_lactation">bayesian_fit_milkbot_single_lactation</a>
            </li>
            <li>
                    <a class="function" href="#brody_model">brody_model</a>
            </li>
            <li>
                    <a class="function" href="#dhanoa_model">dhanoa_model</a>
            </li>
            <li>
                    <a class="function" href="#dijkstra_model">dijkstra_model</a>
            </li>
            <li>
                    <a class="function" href="#emmans_model">emmans_model</a>
            </li>
            <li>
                    <a class="function" href="#fischer_model">fischer_model</a>
            </li>
            <li>
                    <a class="function" href="#fit_lactation_curve">fit_lactation_curve</a>
            </li>
            <li>
                    <a class="function" href="#get_chen_priors">get_chen_priors</a>
            </li>
            <li>
                    <a class="function" href="#get_lc_parameters">get_lc_parameters</a>
            </li>
            <li>
                    <a class="function" href="#get_lc_parameters_least_squares">get_lc_parameters_least_squares</a>
            </li>
            <li>
                    <a class="function" href="#hayashi_model">hayashi_model</a>
            </li>
            <li>
                    <a class="function" href="#milkbot_model">milkbot_model</a>
            </li>
            <li>
                    <a class="function" href="#nelder_model">nelder_model</a>
            </li>
            <li>
                    <a class="function" href="#prasad_model">prasad_model</a>
            </li>
            <li>
                    <a class="function" href="#rook_model">rook_model</a>
            </li>
            <li>
                    <a class="function" href="#sikka_model">sikka_model</a>
            </li>
            <li>
                    <a class="function" href="#wilmink_model">wilmink_model</a>
            </li>
            <li>
                    <a class="function" href="#wood_model">wood_model</a>
            </li>
    </ul>


            <footer>Lactation Curve Package – Bovi-Analytics lab</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../lactationcurve.html">lactationcurve</a><wbr>.fitting    </h1>

                        <div class="docstring"><p>Fitting lactation curves to data.</p>
</div>

                        <input id="mod-fitting-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-fitting-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;Fitting lactation curves to data.&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.lactation_curve_fitting</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>    <span class="n">ali_schaeffer_model</span><span class="p">,</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>    <span class="n">bayesian_fit_milkbot_single_lactation</span><span class="p">,</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>    <span class="n">brody_model</span><span class="p">,</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>    <span class="n">dhanoa_model</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>    <span class="n">dijkstra_model</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>    <span class="n">emmans_model</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="n">fischer_model</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="n">fit_lactation_curve</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="n">get_chen_priors</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="n">get_lc_parameters</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>    <span class="n">get_lc_parameters_least_squares</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>    <span class="n">hayashi_model</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="n">milkbot_model</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="n">nelder_model</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>    <span class="n">prasad_model</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="n">rook_model</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>    <span class="n">sikka_model</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>    <span class="n">wilmink_model</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="n">wood_model</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="s2">&quot;ali_schaeffer_model&quot;</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="s2">&quot;bayesian_fit_milkbot_single_lactation&quot;</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="s2">&quot;brody_model&quot;</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="s2">&quot;dhanoa_model&quot;</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="s2">&quot;dijkstra_model&quot;</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="s2">&quot;emmans_model&quot;</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="s2">&quot;fischer_model&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="s2">&quot;fit_lactation_curve&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="s2">&quot;get_chen_priors&quot;</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="s2">&quot;get_lc_parameters&quot;</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="s2">&quot;get_lc_parameters_least_squares&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="s2">&quot;hayashi_model&quot;</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="s2">&quot;milkbot_model&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="s2">&quot;nelder_model&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="s2">&quot;prasad_model&quot;</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="s2">&quot;rook_model&quot;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="s2">&quot;sikka_model&quot;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="s2">&quot;wilmink_model&quot;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="s2">&quot;wood_model&quot;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="ali_schaeffer_model">
                            <input id="ali_schaeffer_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ali_schaeffer_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span>, </span><span class="param"><span class="n">k</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ali_schaeffer_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ali_schaeffer_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ali_schaeffer_model-128"><a href="#ali_schaeffer_model-128"><span class="linenos">128</span></a><span class="k">def</span><span class="w"> </span><span class="nf">ali_schaeffer_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="ali_schaeffer_model-129"><a href="#ali_schaeffer_model-129"><span class="linenos">129</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ali &amp; Schaeffer lactation curve model.</span>
</span><span id="ali_schaeffer_model-130"><a href="#ali_schaeffer_model-130"><span class="linenos">130</span></a>
</span><span id="ali_schaeffer_model-131"><a href="#ali_schaeffer_model-131"><span class="linenos">131</span></a><span class="sd">    Args:</span>
</span><span id="ali_schaeffer_model-132"><a href="#ali_schaeffer_model-132"><span class="linenos">132</span></a><span class="sd">        t: Time since calving in days (DIM). Use `t &gt;= 1` to avoid `log(0)`.</span>
</span><span id="ali_schaeffer_model-133"><a href="#ali_schaeffer_model-133"><span class="linenos">133</span></a><span class="sd">        a: Intercept-like parameter (numerical).</span>
</span><span id="ali_schaeffer_model-134"><a href="#ali_schaeffer_model-134"><span class="linenos">134</span></a><span class="sd">        b: Linear coefficient on scaled time `t/305` (numerical).</span>
</span><span id="ali_schaeffer_model-135"><a href="#ali_schaeffer_model-135"><span class="linenos">135</span></a><span class="sd">        c: Quadratic coefficient on scaled time `t/305` (numerical).</span>
</span><span id="ali_schaeffer_model-136"><a href="#ali_schaeffer_model-136"><span class="linenos">136</span></a><span class="sd">        d: Coefficient on `log(305/t)` (numerical).</span>
</span><span id="ali_schaeffer_model-137"><a href="#ali_schaeffer_model-137"><span class="linenos">137</span></a><span class="sd">        k: Coefficient on `[log(305/t)]^2` (numerical).</span>
</span><span id="ali_schaeffer_model-138"><a href="#ali_schaeffer_model-138"><span class="linenos">138</span></a>
</span><span id="ali_schaeffer_model-139"><a href="#ali_schaeffer_model-139"><span class="linenos">139</span></a><span class="sd">    Returns:</span>
</span><span id="ali_schaeffer_model-140"><a href="#ali_schaeffer_model-140"><span class="linenos">140</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="ali_schaeffer_model-141"><a href="#ali_schaeffer_model-141"><span class="linenos">141</span></a>
</span><span id="ali_schaeffer_model-142"><a href="#ali_schaeffer_model-142"><span class="linenos">142</span></a><span class="sd">    Notes:</span>
</span><span id="ali_schaeffer_model-143"><a href="#ali_schaeffer_model-143"><span class="linenos">143</span></a><span class="sd">        Uses `t_scaled = t / 305` and `log_term = ln(305 / t)`.</span>
</span><span id="ali_schaeffer_model-144"><a href="#ali_schaeffer_model-144"><span class="linenos">144</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ali_schaeffer_model-145"><a href="#ali_schaeffer_model-145"><span class="linenos">145</span></a>    <span class="n">t_scaled</span> <span class="o">=</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">305</span>
</span><span id="ali_schaeffer_model-146"><a href="#ali_schaeffer_model-146"><span class="linenos">146</span></a>    <span class="n">log_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">305</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span>
</span><span id="ali_schaeffer_model-147"><a href="#ali_schaeffer_model-147"><span class="linenos">147</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t_scaled</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_scaled</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">log_term</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">log_term</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ali &amp; Schaeffer lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM). Use <code>t &gt;= 1</code> to avoid <code>log(0)</code>.</li>
<li><strong>a:</strong>  Intercept-like parameter (numerical).</li>
<li><strong>b:</strong>  Linear coefficient on scaled time <code>t/305</code> (numerical).</li>
<li><strong>c:</strong>  Quadratic coefficient on scaled time <code>t/305</code> (numerical).</li>
<li><strong>d:</strong>  Coefficient on <code>log(305/t)</code> (numerical).</li>
<li><strong>k:</strong>  Coefficient on <code>[log(305/t)]^2</code> (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Uses <code>t_scaled = t / 305</code> and <code>log_term = ln(305 / t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="bayesian_fit_milkbot_single_lactation">
                            <input id="bayesian_fit_milkbot_single_lactation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bayesian_fit_milkbot_single_lactation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dim</span>,</span><span class="param">	<span class="n">milkrecordings</span>,</span><span class="param">	<span class="n">key</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">parity</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">breed</span><span class="o">=</span><span class="s1">&#39;H&#39;</span>,</span><span class="param">	<span class="n">continent</span><span class="o">=</span><span class="s1">&#39;USA&#39;</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="bayesian_fit_milkbot_single_lactation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bayesian_fit_milkbot_single_lactation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bayesian_fit_milkbot_single_lactation-687"><a href="#bayesian_fit_milkbot_single_lactation-687"><span class="linenos">687</span></a><span class="k">def</span><span class="w"> </span><span class="nf">bayesian_fit_milkbot_single_lactation</span><span class="p">(</span>
</span><span id="bayesian_fit_milkbot_single_lactation-688"><a href="#bayesian_fit_milkbot_single_lactation-688"><span class="linenos">688</span></a>    <span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parity</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">breed</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">continent</span><span class="o">=</span><span class="s2">&quot;USA&quot;</span>
</span><span id="bayesian_fit_milkbot_single_lactation-689"><a href="#bayesian_fit_milkbot_single_lactation-689"><span class="linenos">689</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-690"><a href="#bayesian_fit_milkbot_single_lactation-690"><span class="linenos">690</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="bayesian_fit_milkbot_single_lactation-691"><a href="#bayesian_fit_milkbot_single_lactation-691"><span class="linenos">691</span></a><span class="sd">    Fit a single lactation using the MilkBot API.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-692"><a href="#bayesian_fit_milkbot_single_lactation-692"><span class="linenos">692</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-693"><a href="#bayesian_fit_milkbot_single_lactation-693"><span class="linenos">693</span></a><span class="sd">    Args:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-694"><a href="#bayesian_fit_milkbot_single_lactation-694"><span class="linenos">694</span></a><span class="sd">        dim: List/array of DIM values.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-695"><a href="#bayesian_fit_milkbot_single_lactation-695"><span class="linenos">695</span></a><span class="sd">        milkrecordings: List/array of milk recordings (kg).</span>
</span><span id="bayesian_fit_milkbot_single_lactation-696"><a href="#bayesian_fit_milkbot_single_lactation-696"><span class="linenos">696</span></a><span class="sd">        key: API key for MilkBot.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-697"><a href="#bayesian_fit_milkbot_single_lactation-697"><span class="linenos">697</span></a><span class="sd">        parity: Lactation number; values &gt;= 3 are treated as one group in priors.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-698"><a href="#bayesian_fit_milkbot_single_lactation-698"><span class="linenos">698</span></a><span class="sd">        breed: &quot;H&quot; (Holstein) or &quot;J&quot; (Jersey).</span>
</span><span id="bayesian_fit_milkbot_single_lactation-699"><a href="#bayesian_fit_milkbot_single_lactation-699"><span class="linenos">699</span></a><span class="sd">        continent: Prior source:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-700"><a href="#bayesian_fit_milkbot_single_lactation-700"><span class="linenos">700</span></a><span class="sd">            - &quot;USA&quot;   → MilkBot USA priors</span>
</span><span id="bayesian_fit_milkbot_single_lactation-701"><a href="#bayesian_fit_milkbot_single_lactation-701"><span class="linenos">701</span></a><span class="sd">            - &quot;EU&quot;    → MilkBot EU priors</span>
</span><span id="bayesian_fit_milkbot_single_lactation-702"><a href="#bayesian_fit_milkbot_single_lactation-702"><span class="linenos">702</span></a><span class="sd">            - &quot;CHEN&quot;  → Chen et al. published priors</span>
</span><span id="bayesian_fit_milkbot_single_lactation-703"><a href="#bayesian_fit_milkbot_single_lactation-703"><span class="linenos">703</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-704"><a href="#bayesian_fit_milkbot_single_lactation-704"><span class="linenos">704</span></a><span class="sd">    Returns:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-705"><a href="#bayesian_fit_milkbot_single_lactation-705"><span class="linenos">705</span></a><span class="sd">        Dictionary with fitted parameters and metadata:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-706"><a href="#bayesian_fit_milkbot_single_lactation-706"><span class="linenos">706</span></a><span class="sd">            {</span>
</span><span id="bayesian_fit_milkbot_single_lactation-707"><a href="#bayesian_fit_milkbot_single_lactation-707"><span class="linenos">707</span></a><span class="sd">                &quot;scale&quot;: float,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-708"><a href="#bayesian_fit_milkbot_single_lactation-708"><span class="linenos">708</span></a><span class="sd">                &quot;ramp&quot;: float,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-709"><a href="#bayesian_fit_milkbot_single_lactation-709"><span class="linenos">709</span></a><span class="sd">                &quot;decay&quot;: float,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-710"><a href="#bayesian_fit_milkbot_single_lactation-710"><span class="linenos">710</span></a><span class="sd">                &quot;offset&quot;: float,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-711"><a href="#bayesian_fit_milkbot_single_lactation-711"><span class="linenos">711</span></a><span class="sd">                &quot;nPoints&quot;: int</span>
</span><span id="bayesian_fit_milkbot_single_lactation-712"><a href="#bayesian_fit_milkbot_single_lactation-712"><span class="linenos">712</span></a><span class="sd">            }</span>
</span><span id="bayesian_fit_milkbot_single_lactation-713"><a href="#bayesian_fit_milkbot_single_lactation-713"><span class="linenos">713</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-714"><a href="#bayesian_fit_milkbot_single_lactation-714"><span class="linenos">714</span></a><span class="sd">    Raises:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-715"><a href="#bayesian_fit_milkbot_single_lactation-715"><span class="linenos">715</span></a><span class="sd">        requests.HTTPError: For unsuccessful HTTP response codes.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-716"><a href="#bayesian_fit_milkbot_single_lactation-716"><span class="linenos">716</span></a><span class="sd">        RuntimeError: If the response format is unexpected.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-717"><a href="#bayesian_fit_milkbot_single_lactation-717"><span class="linenos">717</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-718"><a href="#bayesian_fit_milkbot_single_lactation-718"><span class="linenos">718</span></a><span class="sd">    Notes:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-719"><a href="#bayesian_fit_milkbot_single_lactation-719"><span class="linenos">719</span></a><span class="sd">        - When `continent == &quot;CHEN&quot;`, Chen et al. priors are included in the request payload.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-720"><a href="#bayesian_fit_milkbot_single_lactation-720"><span class="linenos">720</span></a><span class="sd">        - EU calls use the GCP EU endpoint; others use `milkbot.com`.</span>
</span><span id="bayesian_fit_milkbot_single_lactation-721"><a href="#bayesian_fit_milkbot_single_lactation-721"><span class="linenos">721</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bayesian_fit_milkbot_single_lactation-722"><a href="#bayesian_fit_milkbot_single_lactation-722"><span class="linenos">722</span></a>    <span class="c1"># check and prepare input</span>
</span><span id="bayesian_fit_milkbot_single_lactation-723"><a href="#bayesian_fit_milkbot_single_lactation-723"><span class="linenos">723</span></a>    <span class="n">inputs</span> <span class="o">=</span> <span class="n">validate_and_prepare_inputs</span><span class="p">(</span>
</span><span id="bayesian_fit_milkbot_single_lactation-724"><a href="#bayesian_fit_milkbot_single_lactation-724"><span class="linenos">724</span></a>        <span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">breed</span><span class="o">=</span><span class="n">breed</span><span class="p">,</span> <span class="n">parity</span><span class="o">=</span><span class="n">parity</span><span class="p">,</span> <span class="n">continent</span><span class="o">=</span><span class="n">continent</span>
</span><span id="bayesian_fit_milkbot_single_lactation-725"><a href="#bayesian_fit_milkbot_single_lactation-725"><span class="linenos">725</span></a>    <span class="p">)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-726"><a href="#bayesian_fit_milkbot_single_lactation-726"><span class="linenos">726</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-727"><a href="#bayesian_fit_milkbot_single_lactation-727"><span class="linenos">727</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">dim</span>
</span><span id="bayesian_fit_milkbot_single_lactation-728"><a href="#bayesian_fit_milkbot_single_lactation-728"><span class="linenos">728</span></a>    <span class="n">milkrecordings</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">milkrecordings</span>
</span><span id="bayesian_fit_milkbot_single_lactation-729"><a href="#bayesian_fit_milkbot_single_lactation-729"><span class="linenos">729</span></a>    <span class="n">breed</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">breed</span>
</span><span id="bayesian_fit_milkbot_single_lactation-730"><a href="#bayesian_fit_milkbot_single_lactation-730"><span class="linenos">730</span></a>    <span class="n">parity</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">parity</span>
</span><span id="bayesian_fit_milkbot_single_lactation-731"><a href="#bayesian_fit_milkbot_single_lactation-731"><span class="linenos">731</span></a>    <span class="n">continent</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">continent</span>
</span><span id="bayesian_fit_milkbot_single_lactation-732"><a href="#bayesian_fit_milkbot_single_lactation-732"><span class="linenos">732</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-733"><a href="#bayesian_fit_milkbot_single_lactation-733"><span class="linenos">733</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-734"><a href="#bayesian_fit_milkbot_single_lactation-734"><span class="linenos">734</span></a>    <span class="c1"># Select server (USA vs EU)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-735"><a href="#bayesian_fit_milkbot_single_lactation-735"><span class="linenos">735</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-736"><a href="#bayesian_fit_milkbot_single_lactation-736"><span class="linenos">736</span></a>    <span class="k">if</span> <span class="n">continent</span> <span class="o">==</span> <span class="s2">&quot;EU&quot;</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-737"><a href="#bayesian_fit_milkbot_single_lactation-737"><span class="linenos">737</span></a>        <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://europe-west1-numeric-analogy-337601.cloudfunctions.net/milkBot-fitter&quot;</span>
</span><span id="bayesian_fit_milkbot_single_lactation-738"><a href="#bayesian_fit_milkbot_single_lactation-738"><span class="linenos">738</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-739"><a href="#bayesian_fit_milkbot_single_lactation-739"><span class="linenos">739</span></a>        <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://milkbot.com&quot;</span>
</span><span id="bayesian_fit_milkbot_single_lactation-740"><a href="#bayesian_fit_milkbot_single_lactation-740"><span class="linenos">740</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-741"><a href="#bayesian_fit_milkbot_single_lactation-741"><span class="linenos">741</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-742"><a href="#bayesian_fit_milkbot_single_lactation-742"><span class="linenos">742</span></a>    <span class="c1"># Prepare headers</span>
</span><span id="bayesian_fit_milkbot_single_lactation-743"><a href="#bayesian_fit_milkbot_single_lactation-743"><span class="linenos">743</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-744"><a href="#bayesian_fit_milkbot_single_lactation-744"><span class="linenos">744</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span> <span class="s2">&quot;X-API-KEY&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="bayesian_fit_milkbot_single_lactation-745"><a href="#bayesian_fit_milkbot_single_lactation-745"><span class="linenos">745</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-746"><a href="#bayesian_fit_milkbot_single_lactation-746"><span class="linenos">746</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-747"><a href="#bayesian_fit_milkbot_single_lactation-747"><span class="linenos">747</span></a>    <span class="c1"># Prepare milk points</span>
</span><span id="bayesian_fit_milkbot_single_lactation-748"><a href="#bayesian_fit_milkbot_single_lactation-748"><span class="linenos">748</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-749"><a href="#bayesian_fit_milkbot_single_lactation-749"><span class="linenos">749</span></a>    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="bayesian_fit_milkbot_single_lactation-750"><a href="#bayesian_fit_milkbot_single_lactation-750"><span class="linenos">750</span></a>        <span class="p">({</span><span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot;milk&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">)}</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">)),</span>
</span><span id="bayesian_fit_milkbot_single_lactation-751"><a href="#bayesian_fit_milkbot_single_lactation-751"><span class="linenos">751</span></a>        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;dim&quot;</span><span class="p">],</span>
</span><span id="bayesian_fit_milkbot_single_lactation-752"><a href="#bayesian_fit_milkbot_single_lactation-752"><span class="linenos">752</span></a>    <span class="p">)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-753"><a href="#bayesian_fit_milkbot_single_lactation-753"><span class="linenos">753</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-754"><a href="#bayesian_fit_milkbot_single_lactation-754"><span class="linenos">754</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-755"><a href="#bayesian_fit_milkbot_single_lactation-755"><span class="linenos">755</span></a>    <span class="c1"># Lactation metadata</span>
</span><span id="bayesian_fit_milkbot_single_lactation-756"><a href="#bayesian_fit_milkbot_single_lactation-756"><span class="linenos">756</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-757"><a href="#bayesian_fit_milkbot_single_lactation-757"><span class="linenos">757</span></a>    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="bayesian_fit_milkbot_single_lactation-758"><a href="#bayesian_fit_milkbot_single_lactation-758"><span class="linenos">758</span></a>        <span class="s2">&quot;lactation&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="bayesian_fit_milkbot_single_lactation-759"><a href="#bayesian_fit_milkbot_single_lactation-759"><span class="linenos">759</span></a>            <span class="s2">&quot;lacKey&quot;</span><span class="p">:</span> <span class="s2">&quot;single_lactation_fit&quot;</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-760"><a href="#bayesian_fit_milkbot_single_lactation-760"><span class="linenos">760</span></a>            <span class="s2">&quot;breed&quot;</span><span class="p">:</span> <span class="n">breed</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-761"><a href="#bayesian_fit_milkbot_single_lactation-761"><span class="linenos">761</span></a>            <span class="s2">&quot;parity&quot;</span><span class="p">:</span> <span class="n">parity</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-762"><a href="#bayesian_fit_milkbot_single_lactation-762"><span class="linenos">762</span></a>            <span class="s2">&quot;points&quot;</span><span class="p">:</span> <span class="n">points</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-763"><a href="#bayesian_fit_milkbot_single_lactation-763"><span class="linenos">763</span></a>        <span class="p">},</span>
</span><span id="bayesian_fit_milkbot_single_lactation-764"><a href="#bayesian_fit_milkbot_single_lactation-764"><span class="linenos">764</span></a>        <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="bayesian_fit_milkbot_single_lactation-765"><a href="#bayesian_fit_milkbot_single_lactation-765"><span class="linenos">765</span></a>            <span class="s2">&quot;returnInputData&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-766"><a href="#bayesian_fit_milkbot_single_lactation-766"><span class="linenos">766</span></a>            <span class="s2">&quot;returnPath&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-767"><a href="#bayesian_fit_milkbot_single_lactation-767"><span class="linenos">767</span></a>            <span class="s2">&quot;returnDiscriminatorPath&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-768"><a href="#bayesian_fit_milkbot_single_lactation-768"><span class="linenos">768</span></a>            <span class="c1"># &quot;fitEngine&quot;: &quot;AnnealingFitter@2.0&quot;, #comment out to use the default fitter </span>
</span><span id="bayesian_fit_milkbot_single_lactation-769"><a href="#bayesian_fit_milkbot_single_lactation-769"><span class="linenos">769</span></a>            <span class="c1"># &quot;fitObjective&quot;: &quot;MB2@2.0&quot;,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-770"><a href="#bayesian_fit_milkbot_single_lactation-770"><span class="linenos">770</span></a>            <span class="s2">&quot;preferredMilkUnit&quot;</span><span class="p">:</span> <span class="s2">&quot;kg&quot;</span><span class="p">,</span>
</span><span id="bayesian_fit_milkbot_single_lactation-771"><a href="#bayesian_fit_milkbot_single_lactation-771"><span class="linenos">771</span></a>        <span class="p">},</span>
</span><span id="bayesian_fit_milkbot_single_lactation-772"><a href="#bayesian_fit_milkbot_single_lactation-772"><span class="linenos">772</span></a>    <span class="p">}</span>
</span><span id="bayesian_fit_milkbot_single_lactation-773"><a href="#bayesian_fit_milkbot_single_lactation-773"><span class="linenos">773</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-774"><a href="#bayesian_fit_milkbot_single_lactation-774"><span class="linenos">774</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-775"><a href="#bayesian_fit_milkbot_single_lactation-775"><span class="linenos">775</span></a>    <span class="c1"># Add priors only if Chen</span>
</span><span id="bayesian_fit_milkbot_single_lactation-776"><a href="#bayesian_fit_milkbot_single_lactation-776"><span class="linenos">776</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-777"><a href="#bayesian_fit_milkbot_single_lactation-777"><span class="linenos">777</span></a>    <span class="k">if</span> <span class="n">continent</span> <span class="o">==</span> <span class="s2">&quot;CHEN&quot;</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-778"><a href="#bayesian_fit_milkbot_single_lactation-778"><span class="linenos">778</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;priors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_chen_priors</span><span class="p">(</span><span class="n">parity</span><span class="p">)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-779"><a href="#bayesian_fit_milkbot_single_lactation-779"><span class="linenos">779</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-780"><a href="#bayesian_fit_milkbot_single_lactation-780"><span class="linenos">780</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-781"><a href="#bayesian_fit_milkbot_single_lactation-781"><span class="linenos">781</span></a>    <span class="c1"># Call API</span>
</span><span id="bayesian_fit_milkbot_single_lactation-782"><a href="#bayesian_fit_milkbot_single_lactation-782"><span class="linenos">782</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-783"><a href="#bayesian_fit_milkbot_single_lactation-783"><span class="linenos">783</span></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/fitLactation&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-784"><a href="#bayesian_fit_milkbot_single_lactation-784"><span class="linenos">784</span></a>    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="bayesian_fit_milkbot_single_lactation-785"><a href="#bayesian_fit_milkbot_single_lactation-785"><span class="linenos">785</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="bayesian_fit_milkbot_single_lactation-786"><a href="#bayesian_fit_milkbot_single_lactation-786"><span class="linenos">786</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-787"><a href="#bayesian_fit_milkbot_single_lactation-787"><span class="linenos">787</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-788"><a href="#bayesian_fit_milkbot_single_lactation-788"><span class="linenos">788</span></a>    <span class="c1"># Normalize response (USA vs EU)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-789"><a href="#bayesian_fit_milkbot_single_lactation-789"><span class="linenos">789</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-790"><a href="#bayesian_fit_milkbot_single_lactation-790"><span class="linenos">790</span></a>    <span class="k">if</span> <span class="s2">&quot;fittedParams&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-791"><a href="#bayesian_fit_milkbot_single_lactation-791"><span class="linenos">791</span></a>        <span class="c1"># USA-style response</span>
</span><span id="bayesian_fit_milkbot_single_lactation-792"><a href="#bayesian_fit_milkbot_single_lactation-792"><span class="linenos">792</span></a>        <span class="n">fitted</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;fittedParams&quot;</span><span class="p">]</span>
</span><span id="bayesian_fit_milkbot_single_lactation-793"><a href="#bayesian_fit_milkbot_single_lactation-793"><span class="linenos">793</span></a>    <span class="k">elif</span> <span class="s2">&quot;params&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-794"><a href="#bayesian_fit_milkbot_single_lactation-794"><span class="linenos">794</span></a>        <span class="n">fitted</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span>
</span><span id="bayesian_fit_milkbot_single_lactation-795"><a href="#bayesian_fit_milkbot_single_lactation-795"><span class="linenos">795</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="bayesian_fit_milkbot_single_lactation-796"><a href="#bayesian_fit_milkbot_single_lactation-796"><span class="linenos">796</span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected MilkBot response format: </span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="bayesian_fit_milkbot_single_lactation-797"><a href="#bayesian_fit_milkbot_single_lactation-797"><span class="linenos">797</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-798"><a href="#bayesian_fit_milkbot_single_lactation-798"><span class="linenos">798</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-799"><a href="#bayesian_fit_milkbot_single_lactation-799"><span class="linenos">799</span></a>    <span class="c1"># Parse result</span>
</span><span id="bayesian_fit_milkbot_single_lactation-800"><a href="#bayesian_fit_milkbot_single_lactation-800"><span class="linenos">800</span></a>    <span class="c1"># -----------------------------</span>
</span><span id="bayesian_fit_milkbot_single_lactation-801"><a href="#bayesian_fit_milkbot_single_lactation-801"><span class="linenos">801</span></a>
</span><span id="bayesian_fit_milkbot_single_lactation-802"><a href="#bayesian_fit_milkbot_single_lactation-802"><span class="linenos">802</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="bayesian_fit_milkbot_single_lactation-803"><a href="#bayesian_fit_milkbot_single_lactation-803"><span class="linenos">803</span></a>        <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="n">fitted</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">],</span>
</span><span id="bayesian_fit_milkbot_single_lactation-804"><a href="#bayesian_fit_milkbot_single_lactation-804"><span class="linenos">804</span></a>        <span class="s2">&quot;ramp&quot;</span><span class="p">:</span> <span class="n">fitted</span><span class="p">[</span><span class="s2">&quot;ramp&quot;</span><span class="p">],</span>
</span><span id="bayesian_fit_milkbot_single_lactation-805"><a href="#bayesian_fit_milkbot_single_lactation-805"><span class="linenos">805</span></a>        <span class="s2">&quot;decay&quot;</span><span class="p">:</span> <span class="n">fitted</span><span class="p">[</span><span class="s2">&quot;decay&quot;</span><span class="p">],</span>
</span><span id="bayesian_fit_milkbot_single_lactation-806"><a href="#bayesian_fit_milkbot_single_lactation-806"><span class="linenos">806</span></a>        <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">fitted</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">],</span>
</span><span id="bayesian_fit_milkbot_single_lactation-807"><a href="#bayesian_fit_milkbot_single_lactation-807"><span class="linenos">807</span></a>        <span class="s2">&quot;nPoints&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">),</span>
</span><span id="bayesian_fit_milkbot_single_lactation-808"><a href="#bayesian_fit_milkbot_single_lactation-808"><span class="linenos">808</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Fit a single lactation using the MilkBot API.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>dim:</strong>  List/array of DIM values.</li>
<li><strong>milkrecordings:</strong>  List/array of milk recordings (kg).</li>
<li><strong>key:</strong>  API key for MilkBot.</li>
<li><strong>parity:</strong>  Lactation number; values &gt;= 3 are treated as one group in priors.</li>
<li><strong>breed:</strong>  "H" (Holstein) or "J" (Jersey).</li>
<li><strong>continent:</strong>  Prior source:
<ul>
<li>"USA"   → MilkBot USA priors</li>
<li>"EU"    → MilkBot EU priors</li>
<li>"CHEN"  → Chen et al. published priors</li>
</ul></li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dictionary with fitted parameters and metadata:
      {
          "scale": float,
          "ramp": float,
          "decay": float,
          "offset": float,
          "nPoints": int
      }</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>requests.HTTPError:</strong>  For unsuccessful HTTP response codes.</li>
<li><strong>RuntimeError:</strong>  If the response format is unexpected.</li>
</ul>

<h6 id="notes">Notes:</h6>

<blockquote>
  <ul>
  <li>When <code>continent == "CHEN"</code>, Chen et al. priors are included in the request payload.</li>
  <li>EU calls use the GCP EU endpoint; others use <code>milkbot.com</code>.</li>
  </ul>
</blockquote>
</div>


                </section>
                <section id="brody_model">
                            <input id="brody_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">brody_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">k</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="brody_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#brody_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="brody_model-165"><a href="#brody_model-165"><span class="linenos">165</span></a><span class="k">def</span><span class="w"> </span><span class="nf">brody_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="brody_model-166"><a href="#brody_model-166"><span class="linenos">166</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Brody lactation curve model.</span>
</span><span id="brody_model-167"><a href="#brody_model-167"><span class="linenos">167</span></a>
</span><span id="brody_model-168"><a href="#brody_model-168"><span class="linenos">168</span></a><span class="sd">    Args:</span>
</span><span id="brody_model-169"><a href="#brody_model-169"><span class="linenos">169</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="brody_model-170"><a href="#brody_model-170"><span class="linenos">170</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="brody_model-171"><a href="#brody_model-171"><span class="linenos">171</span></a><span class="sd">        k: Decay parameter (numerical).</span>
</span><span id="brody_model-172"><a href="#brody_model-172"><span class="linenos">172</span></a>
</span><span id="brody_model-173"><a href="#brody_model-173"><span class="linenos">173</span></a><span class="sd">    Returns:</span>
</span><span id="brody_model-174"><a href="#brody_model-174"><span class="linenos">174</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="brody_model-175"><a href="#brody_model-175"><span class="linenos">175</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="brody_model-176"><a href="#brody_model-176"><span class="linenos">176</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Brody lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>k:</strong>  Decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>
</div>


                </section>
                <section id="dhanoa_model">
                            <input id="dhanoa_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dhanoa_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="dhanoa_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#dhanoa_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dhanoa_model-212"><a href="#dhanoa_model-212"><span class="linenos">212</span></a><span class="k">def</span><span class="w"> </span><span class="nf">dhanoa_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="dhanoa_model-213"><a href="#dhanoa_model-213"><span class="linenos">213</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dhanoa lactation curve model.</span>
</span><span id="dhanoa_model-214"><a href="#dhanoa_model-214"><span class="linenos">214</span></a>
</span><span id="dhanoa_model-215"><a href="#dhanoa_model-215"><span class="linenos">215</span></a><span class="sd">    Args:</span>
</span><span id="dhanoa_model-216"><a href="#dhanoa_model-216"><span class="linenos">216</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="dhanoa_model-217"><a href="#dhanoa_model-217"><span class="linenos">217</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="dhanoa_model-218"><a href="#dhanoa_model-218"><span class="linenos">218</span></a><span class="sd">        b: Shape parameter (numerical).</span>
</span><span id="dhanoa_model-219"><a href="#dhanoa_model-219"><span class="linenos">219</span></a><span class="sd">        c: Decay parameter (numerical).</span>
</span><span id="dhanoa_model-220"><a href="#dhanoa_model-220"><span class="linenos">220</span></a>
</span><span id="dhanoa_model-221"><a href="#dhanoa_model-221"><span class="linenos">221</span></a><span class="sd">    Returns:</span>
</span><span id="dhanoa_model-222"><a href="#dhanoa_model-222"><span class="linenos">222</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="dhanoa_model-223"><a href="#dhanoa_model-223"><span class="linenos">223</span></a>
</span><span id="dhanoa_model-224"><a href="#dhanoa_model-224"><span class="linenos">224</span></a><span class="sd">    Notes:</span>
</span><span id="dhanoa_model-225"><a href="#dhanoa_model-225"><span class="linenos">225</span></a><span class="sd">        Formula: `y(t) = a * t ** (b * c) * exp(-c * t)`.</span>
</span><span id="dhanoa_model-226"><a href="#dhanoa_model-226"><span class="linenos">226</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="dhanoa_model-227"><a href="#dhanoa_model-227"><span class="linenos">227</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Dhanoa lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Shape parameter (numerical).</li>
<li><strong>c:</strong>  Decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a * t ** (b * c) * exp(-c * t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="dijkstra_model">
                            <input id="dijkstra_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dijkstra_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="dijkstra_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#dijkstra_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dijkstra_model-287"><a href="#dijkstra_model-287"><span class="linenos">287</span></a><span class="k">def</span><span class="w"> </span><span class="nf">dijkstra_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="dijkstra_model-288"><a href="#dijkstra_model-288"><span class="linenos">288</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dijkstra lactation curve model.</span>
</span><span id="dijkstra_model-289"><a href="#dijkstra_model-289"><span class="linenos">289</span></a>
</span><span id="dijkstra_model-290"><a href="#dijkstra_model-290"><span class="linenos">290</span></a><span class="sd">    Args:</span>
</span><span id="dijkstra_model-291"><a href="#dijkstra_model-291"><span class="linenos">291</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="dijkstra_model-292"><a href="#dijkstra_model-292"><span class="linenos">292</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="dijkstra_model-293"><a href="#dijkstra_model-293"><span class="linenos">293</span></a><span class="sd">        b: Growth parameter (numerical).</span>
</span><span id="dijkstra_model-294"><a href="#dijkstra_model-294"><span class="linenos">294</span></a><span class="sd">        c: Saturation rate parameter (numerical).</span>
</span><span id="dijkstra_model-295"><a href="#dijkstra_model-295"><span class="linenos">295</span></a><span class="sd">        d: Decay parameter (numerical).</span>
</span><span id="dijkstra_model-296"><a href="#dijkstra_model-296"><span class="linenos">296</span></a>
</span><span id="dijkstra_model-297"><a href="#dijkstra_model-297"><span class="linenos">297</span></a><span class="sd">    Returns:</span>
</span><span id="dijkstra_model-298"><a href="#dijkstra_model-298"><span class="linenos">298</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="dijkstra_model-299"><a href="#dijkstra_model-299"><span class="linenos">299</span></a>
</span><span id="dijkstra_model-300"><a href="#dijkstra_model-300"><span class="linenos">300</span></a><span class="sd">    Notes:</span>
</span><span id="dijkstra_model-301"><a href="#dijkstra_model-301"><span class="linenos">301</span></a><span class="sd">        Formula: `y(t) = a * exp((b * (1 - exp(-c * t)) / c) - d * t)`.</span>
</span><span id="dijkstra_model-302"><a href="#dijkstra_model-302"><span class="linenos">302</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="dijkstra_model-303"><a href="#dijkstra_model-303"><span class="linenos">303</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">d</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Dijkstra lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Growth parameter (numerical).</li>
<li><strong>c:</strong>  Saturation rate parameter (numerical).</li>
<li><strong>d:</strong>  Decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a * exp((b * (1 - exp(-c * t)) / c) - d * t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="emmans_model">
                            <input id="emmans_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">emmans_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="emmans_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#emmans_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="emmans_model-230"><a href="#emmans_model-230"><span class="linenos">230</span></a><span class="k">def</span><span class="w"> </span><span class="nf">emmans_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="emmans_model-231"><a href="#emmans_model-231"><span class="linenos">231</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Emmans lactation curve model.</span>
</span><span id="emmans_model-232"><a href="#emmans_model-232"><span class="linenos">232</span></a>
</span><span id="emmans_model-233"><a href="#emmans_model-233"><span class="linenos">233</span></a><span class="sd">    Args:</span>
</span><span id="emmans_model-234"><a href="#emmans_model-234"><span class="linenos">234</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="emmans_model-235"><a href="#emmans_model-235"><span class="linenos">235</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="emmans_model-236"><a href="#emmans_model-236"><span class="linenos">236</span></a><span class="sd">        b: Growth parameter (numerical).</span>
</span><span id="emmans_model-237"><a href="#emmans_model-237"><span class="linenos">237</span></a><span class="sd">        c: Decay parameter (numerical).</span>
</span><span id="emmans_model-238"><a href="#emmans_model-238"><span class="linenos">238</span></a><span class="sd">        d: Location parameter in nested exponential (numerical).</span>
</span><span id="emmans_model-239"><a href="#emmans_model-239"><span class="linenos">239</span></a>
</span><span id="emmans_model-240"><a href="#emmans_model-240"><span class="linenos">240</span></a><span class="sd">    Returns:</span>
</span><span id="emmans_model-241"><a href="#emmans_model-241"><span class="linenos">241</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="emmans_model-242"><a href="#emmans_model-242"><span class="linenos">242</span></a>
</span><span id="emmans_model-243"><a href="#emmans_model-243"><span class="linenos">243</span></a><span class="sd">    Notes:</span>
</span><span id="emmans_model-244"><a href="#emmans_model-244"><span class="linenos">244</span></a><span class="sd">        Formula: `y(t) = a * exp(-exp(d - b*t)) * exp(-c*t)`.</span>
</span><span id="emmans_model-245"><a href="#emmans_model-245"><span class="linenos">245</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="emmans_model-246"><a href="#emmans_model-246"><span class="linenos">246</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Emmans lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Growth parameter (numerical).</li>
<li><strong>c:</strong>  Decay parameter (numerical).</li>
<li><strong>d:</strong>  Location parameter in nested exponential (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a * exp(-exp(d - b*t)) * exp(-c*t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="fischer_model">
                            <input id="fischer_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fischer_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="fischer_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#fischer_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="fischer_model-150"><a href="#fischer_model-150"><span class="linenos">150</span></a><span class="k">def</span><span class="w"> </span><span class="nf">fischer_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="fischer_model-151"><a href="#fischer_model-151"><span class="linenos">151</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fischer lactation curve model.</span>
</span><span id="fischer_model-152"><a href="#fischer_model-152"><span class="linenos">152</span></a>
</span><span id="fischer_model-153"><a href="#fischer_model-153"><span class="linenos">153</span></a><span class="sd">    Args:</span>
</span><span id="fischer_model-154"><a href="#fischer_model-154"><span class="linenos">154</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="fischer_model-155"><a href="#fischer_model-155"><span class="linenos">155</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="fischer_model-156"><a href="#fischer_model-156"><span class="linenos">156</span></a><span class="sd">        b: Linear decline parameter (numerical).</span>
</span><span id="fischer_model-157"><a href="#fischer_model-157"><span class="linenos">157</span></a><span class="sd">        c: Exponential decay parameter (numerical).</span>
</span><span id="fischer_model-158"><a href="#fischer_model-158"><span class="linenos">158</span></a>
</span><span id="fischer_model-159"><a href="#fischer_model-159"><span class="linenos">159</span></a><span class="sd">    Returns:</span>
</span><span id="fischer_model-160"><a href="#fischer_model-160"><span class="linenos">160</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="fischer_model-161"><a href="#fischer_model-161"><span class="linenos">161</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="fischer_model-162"><a href="#fischer_model-162"><span class="linenos">162</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fischer lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Linear decline parameter (numerical).</li>
<li><strong>c:</strong>  Exponential decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>
</div>


                </section>
                <section id="fit_lactation_curve">
                            <input id="fit_lactation_curve-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_lactation_curve</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dim</span>,</span><span class="param">	<span class="n">milkrecordings</span>,</span><span class="param">	<span class="n">model</span><span class="o">=</span><span class="s1">&#39;wood&#39;</span>,</span><span class="param">	<span class="n">fitting</span><span class="o">=</span><span class="s1">&#39;frequentist&#39;</span>,</span><span class="param">	<span class="n">breed</span><span class="o">=</span><span class="s1">&#39;H&#39;</span>,</span><span class="param">	<span class="n">parity</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">continent</span><span class="o">=</span><span class="s1">&#39;USA&#39;</span>,</span><span class="param">	<span class="n">key</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="fit_lactation_curve-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#fit_lactation_curve"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="fit_lactation_curve-367"><a href="#fit_lactation_curve-367"><span class="linenos">367</span></a><span class="k">def</span><span class="w"> </span><span class="nf">fit_lactation_curve</span><span class="p">(</span>
</span><span id="fit_lactation_curve-368"><a href="#fit_lactation_curve-368"><span class="linenos">368</span></a>    <span class="n">dim</span><span class="p">,</span>
</span><span id="fit_lactation_curve-369"><a href="#fit_lactation_curve-369"><span class="linenos">369</span></a>    <span class="n">milkrecordings</span><span class="p">,</span>
</span><span id="fit_lactation_curve-370"><a href="#fit_lactation_curve-370"><span class="linenos">370</span></a>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;wood&quot;</span><span class="p">,</span>
</span><span id="fit_lactation_curve-371"><a href="#fit_lactation_curve-371"><span class="linenos">371</span></a>    <span class="n">fitting</span><span class="o">=</span><span class="s2">&quot;frequentist&quot;</span><span class="p">,</span>
</span><span id="fit_lactation_curve-372"><a href="#fit_lactation_curve-372"><span class="linenos">372</span></a>    <span class="n">breed</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">,</span>
</span><span id="fit_lactation_curve-373"><a href="#fit_lactation_curve-373"><span class="linenos">373</span></a>    <span class="n">parity</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="fit_lactation_curve-374"><a href="#fit_lactation_curve-374"><span class="linenos">374</span></a>    <span class="n">continent</span><span class="o">=</span><span class="s2">&quot;USA&quot;</span><span class="p">,</span>
</span><span id="fit_lactation_curve-375"><a href="#fit_lactation_curve-375"><span class="linenos">375</span></a>    <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="fit_lactation_curve-376"><a href="#fit_lactation_curve-376"><span class="linenos">376</span></a><span class="p">):</span>
</span><span id="fit_lactation_curve-377"><a href="#fit_lactation_curve-377"><span class="linenos">377</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit lactation data to a lactation curve model and return predictions.</span>
</span><span id="fit_lactation_curve-378"><a href="#fit_lactation_curve-378"><span class="linenos">378</span></a>
</span><span id="fit_lactation_curve-379"><a href="#fit_lactation_curve-379"><span class="linenos">379</span></a><span class="sd">    Depending on `fitting`:</span>
</span><span id="fit_lactation_curve-380"><a href="#fit_lactation_curve-380"><span class="linenos">380</span></a><span class="sd">    - **frequentist**: Fits parameters using `minimize` and/or `curve_fit`</span>
</span><span id="fit_lactation_curve-381"><a href="#fit_lactation_curve-381"><span class="linenos">381</span></a><span class="sd">      for the specified `model`, then predicts over DIM 1–305 (or up to `max(dim)` if greater).</span>
</span><span id="fit_lactation_curve-382"><a href="#fit_lactation_curve-382"><span class="linenos">382</span></a><span class="sd">    - **bayesian**: (MilkBot only) Calls the MilkBot Bayesian fitting API and</span>
</span><span id="fit_lactation_curve-383"><a href="#fit_lactation_curve-383"><span class="linenos">383</span></a><span class="sd">      returns predictions using the fitted parameters.</span>
</span><span id="fit_lactation_curve-384"><a href="#fit_lactation_curve-384"><span class="linenos">384</span></a>
</span><span id="fit_lactation_curve-385"><a href="#fit_lactation_curve-385"><span class="linenos">385</span></a><span class="sd">    Args:</span>
</span><span id="fit_lactation_curve-386"><a href="#fit_lactation_curve-386"><span class="linenos">386</span></a><span class="sd">        dim (Int): List/array of days in milk (DIM).</span>
</span><span id="fit_lactation_curve-387"><a href="#fit_lactation_curve-387"><span class="linenos">387</span></a><span class="sd">        milkrecordings (Float): List/array of milk recordings (kg).</span>
</span><span id="fit_lactation_curve-388"><a href="#fit_lactation_curve-388"><span class="linenos">388</span></a><span class="sd">        model (Str): Model name (lowercase), default &quot;wood&quot;.</span>
</span><span id="fit_lactation_curve-389"><a href="#fit_lactation_curve-389"><span class="linenos">389</span></a><span class="sd">            Supported for frequentist: &quot;wood&quot;, &quot;wilmink&quot;, &quot;ali_schaeffer&quot;, &quot;fischer&quot;, &quot;milkbot&quot;.</span>
</span><span id="fit_lactation_curve-390"><a href="#fit_lactation_curve-390"><span class="linenos">390</span></a><span class="sd">        fitting (Str): &quot;frequentist&quot; (default) or &quot;bayesian&quot;.</span>
</span><span id="fit_lactation_curve-391"><a href="#fit_lactation_curve-391"><span class="linenos">391</span></a><span class="sd">            Bayesian fitting is currently implemented only for &quot;milkbot&quot;.</span>
</span><span id="fit_lactation_curve-392"><a href="#fit_lactation_curve-392"><span class="linenos">392</span></a><span class="sd">        breed (Str): &quot;H&quot; (Holstein, default) or &quot;J&quot; (Jersey). Only used for Bayesian.</span>
</span><span id="fit_lactation_curve-393"><a href="#fit_lactation_curve-393"><span class="linenos">393</span></a><span class="sd">        parity (Int): Lactation number; all parities &gt;= 3 considered one group in priors (Bayesian).</span>
</span><span id="fit_lactation_curve-394"><a href="#fit_lactation_curve-394"><span class="linenos">394</span></a><span class="sd">        continent (Str): Prior source for Bayesian, &quot;USA&quot; (default), &quot;EU&quot;, or &quot;CHEN&quot;.</span>
</span><span id="fit_lactation_curve-395"><a href="#fit_lactation_curve-395"><span class="linenos">395</span></a><span class="sd">        key (Str | None): API key for MilkBot (required when `fitting == &quot;bayesian&quot;`).</span>
</span><span id="fit_lactation_curve-396"><a href="#fit_lactation_curve-396"><span class="linenos">396</span></a>
</span><span id="fit_lactation_curve-397"><a href="#fit_lactation_curve-397"><span class="linenos">397</span></a><span class="sd">    Returns:</span>
</span><span id="fit_lactation_curve-398"><a href="#fit_lactation_curve-398"><span class="linenos">398</span></a><span class="sd">        List/array of predicted milk yield for DIM 1–305 (or up to the maximum DIM if &gt; 305).</span>
</span><span id="fit_lactation_curve-399"><a href="#fit_lactation_curve-399"><span class="linenos">399</span></a>
</span><span id="fit_lactation_curve-400"><a href="#fit_lactation_curve-400"><span class="linenos">400</span></a><span class="sd">    Raises:</span>
</span><span id="fit_lactation_curve-401"><a href="#fit_lactation_curve-401"><span class="linenos">401</span></a><span class="sd">        Exception: If an unknown model is requested (frequentist),</span>
</span><span id="fit_lactation_curve-402"><a href="#fit_lactation_curve-402"><span class="linenos">402</span></a><span class="sd">            or Bayesian is requested for a non-MilkBot model,</span>
</span><span id="fit_lactation_curve-403"><a href="#fit_lactation_curve-403"><span class="linenos">403</span></a><span class="sd">            or `key` is missing when Bayesian fitting is requested.</span>
</span><span id="fit_lactation_curve-404"><a href="#fit_lactation_curve-404"><span class="linenos">404</span></a>
</span><span id="fit_lactation_curve-405"><a href="#fit_lactation_curve-405"><span class="linenos">405</span></a><span class="sd">    Notes:</span>
</span><span id="fit_lactation_curve-406"><a href="#fit_lactation_curve-406"><span class="linenos">406</span></a><span class="sd">        Uses `validate_and_prepare_inputs` for input checking and normalization.</span>
</span><span id="fit_lactation_curve-407"><a href="#fit_lactation_curve-407"><span class="linenos">407</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="fit_lactation_curve-408"><a href="#fit_lactation_curve-408"><span class="linenos">408</span></a>    <span class="c1"># check and prepare input</span>
</span><span id="fit_lactation_curve-409"><a href="#fit_lactation_curve-409"><span class="linenos">409</span></a>    <span class="n">inputs</span> <span class="o">=</span> <span class="n">validate_and_prepare_inputs</span><span class="p">(</span>
</span><span id="fit_lactation_curve-410"><a href="#fit_lactation_curve-410"><span class="linenos">410</span></a>        <span class="n">dim</span><span class="p">,</span>
</span><span id="fit_lactation_curve-411"><a href="#fit_lactation_curve-411"><span class="linenos">411</span></a>        <span class="n">milkrecordings</span><span class="p">,</span>
</span><span id="fit_lactation_curve-412"><a href="#fit_lactation_curve-412"><span class="linenos">412</span></a>        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
</span><span id="fit_lactation_curve-413"><a href="#fit_lactation_curve-413"><span class="linenos">413</span></a>        <span class="n">fitting</span><span class="o">=</span><span class="n">fitting</span><span class="p">,</span>
</span><span id="fit_lactation_curve-414"><a href="#fit_lactation_curve-414"><span class="linenos">414</span></a>        <span class="n">breed</span><span class="o">=</span><span class="n">breed</span><span class="p">,</span>
</span><span id="fit_lactation_curve-415"><a href="#fit_lactation_curve-415"><span class="linenos">415</span></a>        <span class="n">parity</span><span class="o">=</span><span class="n">parity</span><span class="p">,</span>
</span><span id="fit_lactation_curve-416"><a href="#fit_lactation_curve-416"><span class="linenos">416</span></a>        <span class="n">continent</span><span class="o">=</span><span class="n">continent</span><span class="p">,</span>
</span><span id="fit_lactation_curve-417"><a href="#fit_lactation_curve-417"><span class="linenos">417</span></a>    <span class="p">)</span>
</span><span id="fit_lactation_curve-418"><a href="#fit_lactation_curve-418"><span class="linenos">418</span></a>
</span><span id="fit_lactation_curve-419"><a href="#fit_lactation_curve-419"><span class="linenos">419</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">dim</span>
</span><span id="fit_lactation_curve-420"><a href="#fit_lactation_curve-420"><span class="linenos">420</span></a>    <span class="n">milkrecordings</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">milkrecordings</span>
</span><span id="fit_lactation_curve-421"><a href="#fit_lactation_curve-421"><span class="linenos">421</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">model</span>
</span><span id="fit_lactation_curve-422"><a href="#fit_lactation_curve-422"><span class="linenos">422</span></a>    <span class="n">fitting</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">fitting</span>
</span><span id="fit_lactation_curve-423"><a href="#fit_lactation_curve-423"><span class="linenos">423</span></a>    <span class="n">breed</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">breed</span>
</span><span id="fit_lactation_curve-424"><a href="#fit_lactation_curve-424"><span class="linenos">424</span></a>    <span class="n">parity</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">parity</span>
</span><span id="fit_lactation_curve-425"><a href="#fit_lactation_curve-425"><span class="linenos">425</span></a>    <span class="n">continent</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">continent</span>
</span><span id="fit_lactation_curve-426"><a href="#fit_lactation_curve-426"><span class="linenos">426</span></a>
</span><span id="fit_lactation_curve-427"><a href="#fit_lactation_curve-427"><span class="linenos">427</span></a>    <span class="k">if</span> <span class="n">fitting</span> <span class="o">==</span> <span class="s2">&quot;frequentist&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-428"><a href="#fit_lactation_curve-428"><span class="linenos">428</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;wood&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-429"><a href="#fit_lactation_curve-429"><span class="linenos">429</span></a>            <span class="n">a_w</span><span class="p">,</span> <span class="n">b_w</span><span class="p">,</span> <span class="n">c_w</span> <span class="o">=</span> <span class="n">get_lc_parameters</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="fit_lactation_curve-430"><a href="#fit_lactation_curve-430"><span class="linenos">430</span></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">305</span><span class="p">:</span>
</span><span id="fit_lactation_curve-431"><a href="#fit_lactation_curve-431"><span class="linenos">431</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="fit_lactation_curve-432"><a href="#fit_lactation_curve-432"><span class="linenos">432</span></a>                <span class="n">y_w</span> <span class="o">=</span> <span class="n">wood_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_w</span><span class="p">,</span> <span class="n">b_w</span><span class="p">,</span> <span class="n">c_w</span><span class="p">)</span>
</span><span id="fit_lactation_curve-433"><a href="#fit_lactation_curve-433"><span class="linenos">433</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-434"><a href="#fit_lactation_curve-434"><span class="linenos">434</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">306</span><span class="p">)</span>
</span><span id="fit_lactation_curve-435"><a href="#fit_lactation_curve-435"><span class="linenos">435</span></a>                <span class="n">y_w</span> <span class="o">=</span> <span class="n">wood_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_w</span><span class="p">,</span> <span class="n">b_w</span><span class="p">,</span> <span class="n">c_w</span><span class="p">)</span>
</span><span id="fit_lactation_curve-436"><a href="#fit_lactation_curve-436"><span class="linenos">436</span></a>            <span class="k">return</span> <span class="n">y_w</span>
</span><span id="fit_lactation_curve-437"><a href="#fit_lactation_curve-437"><span class="linenos">437</span></a>
</span><span id="fit_lactation_curve-438"><a href="#fit_lactation_curve-438"><span class="linenos">438</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;wilmink&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-439"><a href="#fit_lactation_curve-439"><span class="linenos">439</span></a>            <span class="n">a_wil</span><span class="p">,</span> <span class="n">b_wil</span><span class="p">,</span> <span class="n">c_wil</span><span class="p">,</span> <span class="n">k_wil</span> <span class="o">=</span> <span class="n">get_lc_parameters</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="fit_lactation_curve-440"><a href="#fit_lactation_curve-440"><span class="linenos">440</span></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">305</span><span class="p">:</span>
</span><span id="fit_lactation_curve-441"><a href="#fit_lactation_curve-441"><span class="linenos">441</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="fit_lactation_curve-442"><a href="#fit_lactation_curve-442"><span class="linenos">442</span></a>                <span class="n">y_wil</span> <span class="o">=</span> <span class="n">wilmink_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_wil</span><span class="p">,</span> <span class="n">b_wil</span><span class="p">,</span> <span class="n">c_wil</span><span class="p">,</span> <span class="n">k_wil</span><span class="p">)</span>
</span><span id="fit_lactation_curve-443"><a href="#fit_lactation_curve-443"><span class="linenos">443</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-444"><a href="#fit_lactation_curve-444"><span class="linenos">444</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">306</span><span class="p">)</span>
</span><span id="fit_lactation_curve-445"><a href="#fit_lactation_curve-445"><span class="linenos">445</span></a>                <span class="n">y_wil</span> <span class="o">=</span> <span class="n">wilmink_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_wil</span><span class="p">,</span> <span class="n">b_wil</span><span class="p">,</span> <span class="n">c_wil</span><span class="p">,</span> <span class="n">k_wil</span><span class="p">)</span>
</span><span id="fit_lactation_curve-446"><a href="#fit_lactation_curve-446"><span class="linenos">446</span></a>            <span class="k">return</span> <span class="n">y_wil</span>
</span><span id="fit_lactation_curve-447"><a href="#fit_lactation_curve-447"><span class="linenos">447</span></a>
</span><span id="fit_lactation_curve-448"><a href="#fit_lactation_curve-448"><span class="linenos">448</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;ali_schaeffer&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-449"><a href="#fit_lactation_curve-449"><span class="linenos">449</span></a>            <span class="n">a_as</span><span class="p">,</span> <span class="n">b_as</span><span class="p">,</span> <span class="n">c_as</span><span class="p">,</span> <span class="n">d_as</span><span class="p">,</span> <span class="n">k_as</span> <span class="o">=</span> <span class="n">get_lc_parameters</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="fit_lactation_curve-450"><a href="#fit_lactation_curve-450"><span class="linenos">450</span></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">305</span><span class="p">:</span>
</span><span id="fit_lactation_curve-451"><a href="#fit_lactation_curve-451"><span class="linenos">451</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="fit_lactation_curve-452"><a href="#fit_lactation_curve-452"><span class="linenos">452</span></a>                <span class="n">y_as</span> <span class="o">=</span> <span class="n">ali_schaeffer_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_as</span><span class="p">,</span> <span class="n">b_as</span><span class="p">,</span> <span class="n">c_as</span><span class="p">,</span> <span class="n">d_as</span><span class="p">,</span> <span class="n">k_as</span><span class="p">)</span>
</span><span id="fit_lactation_curve-453"><a href="#fit_lactation_curve-453"><span class="linenos">453</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-454"><a href="#fit_lactation_curve-454"><span class="linenos">454</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">306</span><span class="p">)</span>
</span><span id="fit_lactation_curve-455"><a href="#fit_lactation_curve-455"><span class="linenos">455</span></a>                <span class="n">y_as</span> <span class="o">=</span> <span class="n">ali_schaeffer_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_as</span><span class="p">,</span> <span class="n">b_as</span><span class="p">,</span> <span class="n">c_as</span><span class="p">,</span> <span class="n">d_as</span><span class="p">,</span> <span class="n">k_as</span><span class="p">)</span>
</span><span id="fit_lactation_curve-456"><a href="#fit_lactation_curve-456"><span class="linenos">456</span></a>            <span class="k">return</span> <span class="n">y_as</span>
</span><span id="fit_lactation_curve-457"><a href="#fit_lactation_curve-457"><span class="linenos">457</span></a>
</span><span id="fit_lactation_curve-458"><a href="#fit_lactation_curve-458"><span class="linenos">458</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;fischer&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-459"><a href="#fit_lactation_curve-459"><span class="linenos">459</span></a>            <span class="n">a_f</span><span class="p">,</span> <span class="n">b_f</span><span class="p">,</span> <span class="n">c_f</span> <span class="o">=</span> <span class="n">get_lc_parameters</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="fit_lactation_curve-460"><a href="#fit_lactation_curve-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">305</span><span class="p">:</span>
</span><span id="fit_lactation_curve-461"><a href="#fit_lactation_curve-461"><span class="linenos">461</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="fit_lactation_curve-462"><a href="#fit_lactation_curve-462"><span class="linenos">462</span></a>                <span class="n">y_f</span> <span class="o">=</span> <span class="n">fischer_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_f</span><span class="p">,</span> <span class="n">b_f</span><span class="p">,</span> <span class="n">c_f</span><span class="p">)</span>
</span><span id="fit_lactation_curve-463"><a href="#fit_lactation_curve-463"><span class="linenos">463</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-464"><a href="#fit_lactation_curve-464"><span class="linenos">464</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">306</span><span class="p">)</span>
</span><span id="fit_lactation_curve-465"><a href="#fit_lactation_curve-465"><span class="linenos">465</span></a>                <span class="n">y_f</span> <span class="o">=</span> <span class="n">fischer_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_f</span><span class="p">,</span> <span class="n">b_f</span><span class="p">,</span> <span class="n">c_f</span><span class="p">)</span>
</span><span id="fit_lactation_curve-466"><a href="#fit_lactation_curve-466"><span class="linenos">466</span></a>            <span class="k">return</span> <span class="n">y_f</span>
</span><span id="fit_lactation_curve-467"><a href="#fit_lactation_curve-467"><span class="linenos">467</span></a>
</span><span id="fit_lactation_curve-468"><a href="#fit_lactation_curve-468"><span class="linenos">468</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;milkbot&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-469"><a href="#fit_lactation_curve-469"><span class="linenos">469</span></a>            <span class="n">a_mb</span><span class="p">,</span> <span class="n">b_mb</span><span class="p">,</span> <span class="n">c_mb</span><span class="p">,</span> <span class="n">d_mb</span> <span class="o">=</span> <span class="n">get_lc_parameters</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="fit_lactation_curve-470"><a href="#fit_lactation_curve-470"><span class="linenos">470</span></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">305</span><span class="p">:</span>
</span><span id="fit_lactation_curve-471"><a href="#fit_lactation_curve-471"><span class="linenos">471</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="fit_lactation_curve-472"><a href="#fit_lactation_curve-472"><span class="linenos">472</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-473"><a href="#fit_lactation_curve-473"><span class="linenos">473</span></a>                <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">306</span><span class="p">)</span>
</span><span id="fit_lactation_curve-474"><a href="#fit_lactation_curve-474"><span class="linenos">474</span></a>
</span><span id="fit_lactation_curve-475"><a href="#fit_lactation_curve-475"><span class="linenos">475</span></a>            <span class="n">y_mb</span> <span class="o">=</span> <span class="n">milkbot_model</span><span class="p">(</span><span class="n">t_range</span><span class="p">,</span> <span class="n">a_mb</span><span class="p">,</span> <span class="n">b_mb</span><span class="p">,</span> <span class="n">c_mb</span><span class="p">,</span> <span class="n">d_mb</span><span class="p">)</span>
</span><span id="fit_lactation_curve-476"><a href="#fit_lactation_curve-476"><span class="linenos">476</span></a>            <span class="k">return</span> <span class="n">y_mb</span>
</span><span id="fit_lactation_curve-477"><a href="#fit_lactation_curve-477"><span class="linenos">477</span></a>
</span><span id="fit_lactation_curve-478"><a href="#fit_lactation_curve-478"><span class="linenos">478</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-479"><a href="#fit_lactation_curve-479"><span class="linenos">479</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown model&quot;</span><span class="p">)</span>
</span><span id="fit_lactation_curve-480"><a href="#fit_lactation_curve-480"><span class="linenos">480</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-481"><a href="#fit_lactation_curve-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;milkbot&quot;</span><span class="p">:</span>
</span><span id="fit_lactation_curve-482"><a href="#fit_lactation_curve-482"><span class="linenos">482</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="fit_lactation_curve-483"><a href="#fit_lactation_curve-483"><span class="linenos">483</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Key needed to use Bayesian fitting engine milkbot&quot;</span><span class="p">)</span>
</span><span id="fit_lactation_curve-484"><a href="#fit_lactation_curve-484"><span class="linenos">484</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-485"><a href="#fit_lactation_curve-485"><span class="linenos">485</span></a>                <span class="n">parameters</span> <span class="o">=</span> <span class="n">bayesian_fit_milkbot_single_lactation</span><span class="p">(</span>
</span><span id="fit_lactation_curve-486"><a href="#fit_lactation_curve-486"><span class="linenos">486</span></a>                    <span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">parity</span><span class="p">,</span> <span class="n">breed</span><span class="p">,</span> <span class="n">continent</span>
</span><span id="fit_lactation_curve-487"><a href="#fit_lactation_curve-487"><span class="linenos">487</span></a>                <span class="p">)</span>
</span><span id="fit_lactation_curve-488"><a href="#fit_lactation_curve-488"><span class="linenos">488</span></a>                <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">305</span><span class="p">:</span>
</span><span id="fit_lactation_curve-489"><a href="#fit_lactation_curve-489"><span class="linenos">489</span></a>                    <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="fit_lactation_curve-490"><a href="#fit_lactation_curve-490"><span class="linenos">490</span></a>                    <span class="n">y_mb_bay</span> <span class="o">=</span> <span class="n">milkbot_model</span><span class="p">(</span>
</span><span id="fit_lactation_curve-491"><a href="#fit_lactation_curve-491"><span class="linenos">491</span></a>                        <span class="n">t_range</span><span class="p">,</span>
</span><span id="fit_lactation_curve-492"><a href="#fit_lactation_curve-492"><span class="linenos">492</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-493"><a href="#fit_lactation_curve-493"><span class="linenos">493</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;ramp&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-494"><a href="#fit_lactation_curve-494"><span class="linenos">494</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-495"><a href="#fit_lactation_curve-495"><span class="linenos">495</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;decay&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-496"><a href="#fit_lactation_curve-496"><span class="linenos">496</span></a>                    <span class="p">)</span>
</span><span id="fit_lactation_curve-497"><a href="#fit_lactation_curve-497"><span class="linenos">497</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-498"><a href="#fit_lactation_curve-498"><span class="linenos">498</span></a>                    <span class="n">t_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">306</span><span class="p">)</span>
</span><span id="fit_lactation_curve-499"><a href="#fit_lactation_curve-499"><span class="linenos">499</span></a>                    <span class="n">y_mb_bay</span> <span class="o">=</span> <span class="n">milkbot_model</span><span class="p">(</span>
</span><span id="fit_lactation_curve-500"><a href="#fit_lactation_curve-500"><span class="linenos">500</span></a>                        <span class="n">t_range</span><span class="p">,</span>
</span><span id="fit_lactation_curve-501"><a href="#fit_lactation_curve-501"><span class="linenos">501</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-502"><a href="#fit_lactation_curve-502"><span class="linenos">502</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;ramp&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-503"><a href="#fit_lactation_curve-503"><span class="linenos">503</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;offset&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-504"><a href="#fit_lactation_curve-504"><span class="linenos">504</span></a>                        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;decay&quot;</span><span class="p">],</span>
</span><span id="fit_lactation_curve-505"><a href="#fit_lactation_curve-505"><span class="linenos">505</span></a>                    <span class="p">)</span>
</span><span id="fit_lactation_curve-506"><a href="#fit_lactation_curve-506"><span class="linenos">506</span></a>                <span class="k">return</span> <span class="n">y_mb_bay</span>
</span><span id="fit_lactation_curve-507"><a href="#fit_lactation_curve-507"><span class="linenos">507</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="fit_lactation_curve-508"><a href="#fit_lactation_curve-508"><span class="linenos">508</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Bayesian fitting is currently only implemented for milkbot models&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fit lactation data to a lactation curve model and return predictions.</p>

<p>Depending on <code>fitting</code>:</p>

<ul>
<li><strong>frequentist</strong>: Fits parameters using <code>minimize</code> and/or <code>curve_fit</code>
for the specified <code>model</code>, then predicts over DIM 1–305 (or up to <code>max(dim)</code> if greater).</li>
<li><strong>bayesian</strong>: (MilkBot only) Calls the MilkBot Bayesian fitting API and
returns predictions using the fitted parameters.</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>dim (Int):</strong>  List/array of days in milk (DIM).</li>
<li><strong>milkrecordings (Float):</strong>  List/array of milk recordings (kg).</li>
<li><strong>model (Str):</strong>  Model name (lowercase), default "wood".
Supported for frequentist: "wood", "wilmink", "ali_schaeffer", "fischer", "milkbot".</li>
<li><strong>fitting (Str):</strong>  "frequentist" (default) or "bayesian".
Bayesian fitting is currently implemented only for "milkbot".</li>
<li><strong>breed (Str):</strong>  "H" (Holstein, default) or "J" (Jersey). Only used for Bayesian.</li>
<li><strong>parity (Int):</strong>  Lactation number; all parities &gt;= 3 considered one group in priors (Bayesian).</li>
<li><strong>continent (Str):</strong>  Prior source for Bayesian, "USA" (default), "EU", or "CHEN".</li>
<li><strong>key (Str | None):</strong>  API key for MilkBot (required when <code>fitting == "bayesian"</code>).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List/array of predicted milk yield for DIM 1–305 (or up to the maximum DIM if &gt; 305).</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>Exception:</strong>  If an unknown model is requested (frequentist),
or Bayesian is requested for a non-MilkBot model,
or <code>key</code> is missing when Bayesian fitting is requested.</li>
</ul>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Uses <code>validate_and_prepare_inputs</code> for input checking and normalization.</p>
</blockquote>
</div>


                </section>
                <section id="get_chen_priors">
                            <input id="get_chen_priors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_chen_priors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parity</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="get_chen_priors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_chen_priors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_chen_priors-640"><a href="#get_chen_priors-640"><span class="linenos">640</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_chen_priors</span><span class="p">(</span><span class="n">parity</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="get_chen_priors-641"><a href="#get_chen_priors-641"><span class="linenos">641</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_chen_priors-642"><a href="#get_chen_priors-642"><span class="linenos">642</span></a><span class="sd">    Return Chen et al. priors in MilkBot format.</span>
</span><span id="get_chen_priors-643"><a href="#get_chen_priors-643"><span class="linenos">643</span></a>
</span><span id="get_chen_priors-644"><a href="#get_chen_priors-644"><span class="linenos">644</span></a><span class="sd">    Args:</span>
</span><span id="get_chen_priors-645"><a href="#get_chen_priors-645"><span class="linenos">645</span></a><span class="sd">        parity: Lactation number (1, 2, or &gt;= 3).</span>
</span><span id="get_chen_priors-646"><a href="#get_chen_priors-646"><span class="linenos">646</span></a>
</span><span id="get_chen_priors-647"><a href="#get_chen_priors-647"><span class="linenos">647</span></a><span class="sd">    Returns:</span>
</span><span id="get_chen_priors-648"><a href="#get_chen_priors-648"><span class="linenos">648</span></a><span class="sd">        Dictionary with parameter priors:</span>
</span><span id="get_chen_priors-649"><a href="#get_chen_priors-649"><span class="linenos">649</span></a><span class="sd">        - &quot;scale&quot;: {&quot;mean&quot;, &quot;sd&quot;}</span>
</span><span id="get_chen_priors-650"><a href="#get_chen_priors-650"><span class="linenos">650</span></a><span class="sd">        - &quot;ramp&quot;: {&quot;mean&quot;, &quot;sd&quot;}</span>
</span><span id="get_chen_priors-651"><a href="#get_chen_priors-651"><span class="linenos">651</span></a><span class="sd">        - &quot;decay&quot;: {&quot;mean&quot;, &quot;sd&quot;}</span>
</span><span id="get_chen_priors-652"><a href="#get_chen_priors-652"><span class="linenos">652</span></a><span class="sd">        - &quot;offset&quot;: {&quot;mean&quot;, &quot;sd&quot;}</span>
</span><span id="get_chen_priors-653"><a href="#get_chen_priors-653"><span class="linenos">653</span></a><span class="sd">        - &quot;seMilk&quot;: Standard error of milk measurement.</span>
</span><span id="get_chen_priors-654"><a href="#get_chen_priors-654"><span class="linenos">654</span></a><span class="sd">        - &quot;milkUnit&quot;: Unit string (e.g., &quot;kg&quot;).</span>
</span><span id="get_chen_priors-655"><a href="#get_chen_priors-655"><span class="linenos">655</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_chen_priors-656"><a href="#get_chen_priors-656"><span class="linenos">656</span></a>    <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="get_chen_priors-657"><a href="#get_chen_priors-657"><span class="linenos">657</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="get_chen_priors-658"><a href="#get_chen_priors-658"><span class="linenos">658</span></a>            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">34.11</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
</span><span id="get_chen_priors-659"><a href="#get_chen_priors-659"><span class="linenos">659</span></a>            <span class="s2">&quot;ramp&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">29.96</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
</span><span id="get_chen_priors-660"><a href="#get_chen_priors-660"><span class="linenos">660</span></a>            <span class="s2">&quot;decay&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">0.001835</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">0.000738</span><span class="p">},</span>
</span><span id="get_chen_priors-661"><a href="#get_chen_priors-661"><span class="linenos">661</span></a>            <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
</span><span id="get_chen_priors-662"><a href="#get_chen_priors-662"><span class="linenos">662</span></a>            <span class="s2">&quot;seMilk&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="get_chen_priors-663"><a href="#get_chen_priors-663"><span class="linenos">663</span></a>            <span class="s2">&quot;milkUnit&quot;</span><span class="p">:</span> <span class="s2">&quot;kg&quot;</span><span class="p">,</span>
</span><span id="get_chen_priors-664"><a href="#get_chen_priors-664"><span class="linenos">664</span></a>        <span class="p">}</span>
</span><span id="get_chen_priors-665"><a href="#get_chen_priors-665"><span class="linenos">665</span></a>
</span><span id="get_chen_priors-666"><a href="#get_chen_priors-666"><span class="linenos">666</span></a>    <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="get_chen_priors-667"><a href="#get_chen_priors-667"><span class="linenos">667</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="get_chen_priors-668"><a href="#get_chen_priors-668"><span class="linenos">668</span></a>            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">44.26</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">9.57</span><span class="p">},</span>
</span><span id="get_chen_priors-669"><a href="#get_chen_priors-669"><span class="linenos">669</span></a>            <span class="s2">&quot;ramp&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">22.52</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
</span><span id="get_chen_priors-670"><a href="#get_chen_priors-670"><span class="linenos">670</span></a>            <span class="s2">&quot;decay&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">0.002745</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">0.000979</span><span class="p">},</span>
</span><span id="get_chen_priors-671"><a href="#get_chen_priors-671"><span class="linenos">671</span></a>            <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.78</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">0.07</span><span class="p">},</span>
</span><span id="get_chen_priors-672"><a href="#get_chen_priors-672"><span class="linenos">672</span></a>            <span class="s2">&quot;seMilk&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="get_chen_priors-673"><a href="#get_chen_priors-673"><span class="linenos">673</span></a>            <span class="s2">&quot;milkUnit&quot;</span><span class="p">:</span> <span class="s2">&quot;kg&quot;</span><span class="p">,</span>
</span><span id="get_chen_priors-674"><a href="#get_chen_priors-674"><span class="linenos">674</span></a>        <span class="p">}</span>
</span><span id="get_chen_priors-675"><a href="#get_chen_priors-675"><span class="linenos">675</span></a>
</span><span id="get_chen_priors-676"><a href="#get_chen_priors-676"><span class="linenos">676</span></a>    <span class="c1"># parity &gt;= 3</span>
</span><span id="get_chen_priors-677"><a href="#get_chen_priors-677"><span class="linenos">677</span></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="get_chen_priors-678"><a href="#get_chen_priors-678"><span class="linenos">678</span></a>        <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">48.41</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">10.66</span><span class="p">},</span>
</span><span id="get_chen_priors-679"><a href="#get_chen_priors-679"><span class="linenos">679</span></a>        <span class="s2">&quot;ramp&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">22.54</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">8.724</span><span class="p">},</span>
</span><span id="get_chen_priors-680"><a href="#get_chen_priors-680"><span class="linenos">680</span></a>        <span class="s2">&quot;decay&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">0.002997</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">0.000972</span><span class="p">},</span>
</span><span id="get_chen_priors-681"><a href="#get_chen_priors-681"><span class="linenos">681</span></a>        <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">},</span>
</span><span id="get_chen_priors-682"><a href="#get_chen_priors-682"><span class="linenos">682</span></a>        <span class="s2">&quot;seMilk&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="get_chen_priors-683"><a href="#get_chen_priors-683"><span class="linenos">683</span></a>        <span class="s2">&quot;milkUnit&quot;</span><span class="p">:</span> <span class="s2">&quot;kg&quot;</span><span class="p">,</span>
</span><span id="get_chen_priors-684"><a href="#get_chen_priors-684"><span class="linenos">684</span></a>    <span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Return Chen et al. priors in MilkBot format.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>parity:</strong>  Lactation number (1, 2, or &gt;= 3).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dictionary with parameter priors:</p>
  
  <ul>
  <li>"scale": {"mean", "sd"}</li>
  <li>"ramp": {"mean", "sd"}</li>
  <li>"decay": {"mean", "sd"}</li>
  <li>"offset": {"mean", "sd"}</li>
  <li>"seMilk": Standard error of milk measurement.</li>
  <li>"milkUnit": Unit string (e.g., "kg").</li>
  </ul>
</blockquote>
</div>


                </section>
                <section id="get_lc_parameters">
                            <input id="get_lc_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_lc_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dim</span>, </span><span class="param"><span class="n">milkrecordings</span>, </span><span class="param"><span class="n">model</span><span class="o">=</span><span class="s1">&#39;wood&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_lc_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_lc_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_lc_parameters-569"><a href="#get_lc_parameters-569"><span class="linenos">569</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_lc_parameters</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;wood&quot;</span><span class="p">):</span>
</span><span id="get_lc_parameters-570"><a href="#get_lc_parameters-570"><span class="linenos">570</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit lactation data to a model and return fitted parameters (frequentist).</span>
</span><span id="get_lc_parameters-571"><a href="#get_lc_parameters-571"><span class="linenos">571</span></a>
</span><span id="get_lc_parameters-572"><a href="#get_lc_parameters-572"><span class="linenos">572</span></a><span class="sd">    Depending on `model`, this uses `scipy.optimize.minimize` and/or</span>
</span><span id="get_lc_parameters-573"><a href="#get_lc_parameters-573"><span class="linenos">573</span></a><span class="sd">    `scipy.optimize.curve_fit` with model-specific starting values and bounds.</span>
</span><span id="get_lc_parameters-574"><a href="#get_lc_parameters-574"><span class="linenos">574</span></a>
</span><span id="get_lc_parameters-575"><a href="#get_lc_parameters-575"><span class="linenos">575</span></a><span class="sd">    Args:</span>
</span><span id="get_lc_parameters-576"><a href="#get_lc_parameters-576"><span class="linenos">576</span></a><span class="sd">        dim (int): List/array of DIM values.</span>
</span><span id="get_lc_parameters-577"><a href="#get_lc_parameters-577"><span class="linenos">577</span></a><span class="sd">        milkrecordings (float): List/array of milk recordings (kg).</span>
</span><span id="get_lc_parameters-578"><a href="#get_lc_parameters-578"><span class="linenos">578</span></a><span class="sd">        model (str): One of &quot;wood&quot;, &quot;wilmink&quot;, &quot;ali_schaeffer&quot;, &quot;fischer&quot;, &quot;milkbot&quot;.</span>
</span><span id="get_lc_parameters-579"><a href="#get_lc_parameters-579"><span class="linenos">579</span></a>
</span><span id="get_lc_parameters-580"><a href="#get_lc_parameters-580"><span class="linenos">580</span></a><span class="sd">    Returns:</span>
</span><span id="get_lc_parameters-581"><a href="#get_lc_parameters-581"><span class="linenos">581</span></a><span class="sd">        Fitted parameters as floats, in alphabetical order by parameter name:</span>
</span><span id="get_lc_parameters-582"><a href="#get_lc_parameters-582"><span class="linenos">582</span></a><span class="sd">            - wood: (a, b, c)</span>
</span><span id="get_lc_parameters-583"><a href="#get_lc_parameters-583"><span class="linenos">583</span></a><span class="sd">            - wilmink: (a, b, c, k) with k fixed at -0.05</span>
</span><span id="get_lc_parameters-584"><a href="#get_lc_parameters-584"><span class="linenos">584</span></a><span class="sd">            - ali_schaeffer: (a, b, c, d, k)</span>
</span><span id="get_lc_parameters-585"><a href="#get_lc_parameters-585"><span class="linenos">585</span></a><span class="sd">            - fischer: (a, b, c)</span>
</span><span id="get_lc_parameters-586"><a href="#get_lc_parameters-586"><span class="linenos">586</span></a><span class="sd">            - milkbot: (a, b, c, d)</span>
</span><span id="get_lc_parameters-587"><a href="#get_lc_parameters-587"><span class="linenos">587</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_lc_parameters-588"><a href="#get_lc_parameters-588"><span class="linenos">588</span></a>    <span class="c1"># check and prepare input</span>
</span><span id="get_lc_parameters-589"><a href="#get_lc_parameters-589"><span class="linenos">589</span></a>    <span class="n">inputs</span> <span class="o">=</span> <span class="n">validate_and_prepare_inputs</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="get_lc_parameters-590"><a href="#get_lc_parameters-590"><span class="linenos">590</span></a>
</span><span id="get_lc_parameters-591"><a href="#get_lc_parameters-591"><span class="linenos">591</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">dim</span>
</span><span id="get_lc_parameters-592"><a href="#get_lc_parameters-592"><span class="linenos">592</span></a>    <span class="n">milkrecordings</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">milkrecordings</span>
</span><span id="get_lc_parameters-593"><a href="#get_lc_parameters-593"><span class="linenos">593</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">model</span>
</span><span id="get_lc_parameters-594"><a href="#get_lc_parameters-594"><span class="linenos">594</span></a>
</span><span id="get_lc_parameters-595"><a href="#get_lc_parameters-595"><span class="linenos">595</span></a>    <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;wood&quot;</span><span class="p">:</span>
</span><span id="get_lc_parameters-596"><a href="#get_lc_parameters-596"><span class="linenos">596</span></a>        <span class="n">wood_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
</span><span id="get_lc_parameters-597"><a href="#get_lc_parameters-597"><span class="linenos">597</span></a>        <span class="n">wood_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span>
</span><span id="get_lc_parameters-598"><a href="#get_lc_parameters-598"><span class="linenos">598</span></a>        <span class="n">wood_res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="get_lc_parameters-599"><a href="#get_lc_parameters-599"><span class="linenos">599</span></a>            <span class="n">wood_objective</span><span class="p">,</span> <span class="n">wood_guess</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">),</span> <span class="n">bounds</span><span class="o">=</span><span class="n">wood_bounds</span>
</span><span id="get_lc_parameters-600"><a href="#get_lc_parameters-600"><span class="linenos">600</span></a>        <span class="p">)</span>
</span><span id="get_lc_parameters-601"><a href="#get_lc_parameters-601"><span class="linenos">601</span></a>        <span class="n">a_w</span><span class="p">,</span> <span class="n">b_w</span><span class="p">,</span> <span class="n">c_w</span> <span class="o">=</span> <span class="n">wood_res</span><span class="o">.</span><span class="n">x</span>
</span><span id="get_lc_parameters-602"><a href="#get_lc_parameters-602"><span class="linenos">602</span></a>        <span class="k">return</span> <span class="n">a_w</span><span class="p">,</span> <span class="n">b_w</span><span class="p">,</span> <span class="n">c_w</span>
</span><span id="get_lc_parameters-603"><a href="#get_lc_parameters-603"><span class="linenos">603</span></a>
</span><span id="get_lc_parameters-604"><a href="#get_lc_parameters-604"><span class="linenos">604</span></a>    <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;wilmink&quot;</span><span class="p">:</span>
</span><span id="get_lc_parameters-605"><a href="#get_lc_parameters-605"><span class="linenos">605</span></a>        <span class="n">wil_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
</span><span id="get_lc_parameters-606"><a href="#get_lc_parameters-606"><span class="linenos">606</span></a>        <span class="n">wil_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">wilmink_model</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">wil_guess</span><span class="p">)</span>
</span><span id="get_lc_parameters-607"><a href="#get_lc_parameters-607"><span class="linenos">607</span></a>        <span class="n">a_wil</span><span class="p">,</span> <span class="n">b_wil</span><span class="p">,</span> <span class="n">c_wil</span> <span class="o">=</span> <span class="n">wil_params</span>
</span><span id="get_lc_parameters-608"><a href="#get_lc_parameters-608"><span class="linenos">608</span></a>        <span class="n">k_wil</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>  <span class="c1"># set fixed</span>
</span><span id="get_lc_parameters-609"><a href="#get_lc_parameters-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="n">a_wil</span><span class="p">,</span> <span class="n">b_wil</span><span class="p">,</span> <span class="n">c_wil</span><span class="p">,</span> <span class="n">k_wil</span>
</span><span id="get_lc_parameters-610"><a href="#get_lc_parameters-610"><span class="linenos">610</span></a>
</span><span id="get_lc_parameters-611"><a href="#get_lc_parameters-611"><span class="linenos">611</span></a>    <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;ali_schaeffer&quot;</span><span class="p">:</span>
</span><span id="get_lc_parameters-612"><a href="#get_lc_parameters-612"><span class="linenos">612</span></a>        <span class="n">ali_schaeffer_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="get_lc_parameters-613"><a href="#get_lc_parameters-613"><span class="linenos">613</span></a>        <span class="n">ali_schaeffer_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
</span><span id="get_lc_parameters-614"><a href="#get_lc_parameters-614"><span class="linenos">614</span></a>            <span class="n">ali_schaeffer_model</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">ali_schaeffer_guess</span>
</span><span id="get_lc_parameters-615"><a href="#get_lc_parameters-615"><span class="linenos">615</span></a>        <span class="p">)</span>
</span><span id="get_lc_parameters-616"><a href="#get_lc_parameters-616"><span class="linenos">616</span></a>        <span class="n">a_as</span><span class="p">,</span> <span class="n">b_as</span><span class="p">,</span> <span class="n">c_as</span><span class="p">,</span> <span class="n">d_as</span><span class="p">,</span> <span class="n">k_as</span> <span class="o">=</span> <span class="n">ali_schaeffer_params</span>
</span><span id="get_lc_parameters-617"><a href="#get_lc_parameters-617"><span class="linenos">617</span></a>        <span class="k">return</span> <span class="n">a_as</span><span class="p">,</span> <span class="n">b_as</span><span class="p">,</span> <span class="n">c_as</span><span class="p">,</span> <span class="n">d_as</span><span class="p">,</span> <span class="n">k_as</span>
</span><span id="get_lc_parameters-618"><a href="#get_lc_parameters-618"><span class="linenos">618</span></a>
</span><span id="get_lc_parameters-619"><a href="#get_lc_parameters-619"><span class="linenos">619</span></a>    <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;fischer&quot;</span><span class="p">:</span>
</span><span id="get_lc_parameters-620"><a href="#get_lc_parameters-620"><span class="linenos">620</span></a>        <span class="n">fischer_guess</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">milkrecordings</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
</span><span id="get_lc_parameters-621"><a href="#get_lc_parameters-621"><span class="linenos">621</span></a>        <span class="n">fischer_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="get_lc_parameters-622"><a href="#get_lc_parameters-622"><span class="linenos">622</span></a>        <span class="n">fischer_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
</span><span id="get_lc_parameters-623"><a href="#get_lc_parameters-623"><span class="linenos">623</span></a>            <span class="n">fischer_model</span><span class="p">,</span>
</span><span id="get_lc_parameters-624"><a href="#get_lc_parameters-624"><span class="linenos">624</span></a>            <span class="n">dim</span><span class="p">,</span>
</span><span id="get_lc_parameters-625"><a href="#get_lc_parameters-625"><span class="linenos">625</span></a>            <span class="n">milkrecordings</span><span class="p">,</span>
</span><span id="get_lc_parameters-626"><a href="#get_lc_parameters-626"><span class="linenos">626</span></a>            <span class="n">p0</span><span class="o">=</span><span class="n">fischer_guess</span><span class="p">,</span>
</span><span id="get_lc_parameters-627"><a href="#get_lc_parameters-627"><span class="linenos">627</span></a>            <span class="n">bounds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">fischer_bounds</span><span class="p">),</span>
</span><span id="get_lc_parameters-628"><a href="#get_lc_parameters-628"><span class="linenos">628</span></a>        <span class="p">)</span>
</span><span id="get_lc_parameters-629"><a href="#get_lc_parameters-629"><span class="linenos">629</span></a>        <span class="n">a_f</span><span class="p">,</span> <span class="n">b_f</span><span class="p">,</span> <span class="n">c_f</span> <span class="o">=</span> <span class="n">fischer_params</span>
</span><span id="get_lc_parameters-630"><a href="#get_lc_parameters-630"><span class="linenos">630</span></a>        <span class="k">return</span> <span class="n">a_f</span><span class="p">,</span> <span class="n">b_f</span><span class="p">,</span> <span class="n">c_f</span>
</span><span id="get_lc_parameters-631"><a href="#get_lc_parameters-631"><span class="linenos">631</span></a>
</span><span id="get_lc_parameters-632"><a href="#get_lc_parameters-632"><span class="linenos">632</span></a>    <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="s2">&quot;milkbot&quot;</span><span class="p">:</span>
</span><span id="get_lc_parameters-633"><a href="#get_lc_parameters-633"><span class="linenos">633</span></a>        <span class="n">mb_guess</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">milkrecordings</span><span class="p">),</span> <span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">]</span>
</span><span id="get_lc_parameters-634"><a href="#get_lc_parameters-634"><span class="linenos">634</span></a>        <span class="n">mb_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span>
</span><span id="get_lc_parameters-635"><a href="#get_lc_parameters-635"><span class="linenos">635</span></a>        <span class="n">mb_res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">milkbot_objective</span><span class="p">,</span> <span class="n">mb_guess</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">),</span> <span class="n">bounds</span><span class="o">=</span><span class="n">mb_bounds</span><span class="p">)</span>
</span><span id="get_lc_parameters-636"><a href="#get_lc_parameters-636"><span class="linenos">636</span></a>        <span class="n">a_mb</span><span class="p">,</span> <span class="n">b_mb</span><span class="p">,</span> <span class="n">c_mb</span><span class="p">,</span> <span class="n">d_mb</span> <span class="o">=</span> <span class="n">mb_res</span><span class="o">.</span><span class="n">x</span>
</span><span id="get_lc_parameters-637"><a href="#get_lc_parameters-637"><span class="linenos">637</span></a>        <span class="k">return</span> <span class="n">a_mb</span><span class="p">,</span> <span class="n">b_mb</span><span class="p">,</span> <span class="n">c_mb</span><span class="p">,</span> <span class="n">d_mb</span>
</span></pre></div>


            <div class="docstring"><p>Fit lactation data to a model and return fitted parameters (frequentist).</p>

<p>Depending on <code>model</code>, this uses <code>scipy.optimize.minimize</code> and/or
<code>scipy.optimize.curve_fit</code> with model-specific starting values and bounds.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>dim (int):</strong>  List/array of DIM values.</li>
<li><strong>milkrecordings (float):</strong>  List/array of milk recordings (kg).</li>
<li><strong>model (str):</strong>  One of "wood", "wilmink", "ali_schaeffer", "fischer", "milkbot".</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Fitted parameters as floats, in alphabetical order by parameter name:
      - wood: (a, b, c)
      - wilmink: (a, b, c, k) with k fixed at -0.05
      - ali_schaeffer: (a, b, c, d, k)
      - fischer: (a, b, c)
      - milkbot: (a, b, c, d)</p>
</blockquote>
</div>


                </section>
                <section id="get_lc_parameters_least_squares">
                            <input id="get_lc_parameters_least_squares-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_lc_parameters_least_squares</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dim</span>, </span><span class="param"><span class="n">milkrecordings</span>, </span><span class="param"><span class="n">model</span><span class="o">=</span><span class="s1">&#39;milkbot&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_lc_parameters_least_squares-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_lc_parameters_least_squares"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_lc_parameters_least_squares-511"><a href="#get_lc_parameters_least_squares-511"><span class="linenos">511</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_lc_parameters_least_squares</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;milkbot&quot;</span><span class="p">):</span>
</span><span id="get_lc_parameters_least_squares-512"><a href="#get_lc_parameters_least_squares-512"><span class="linenos">512</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit lactation data and return model parameters (least squares; frequentist).</span>
</span><span id="get_lc_parameters_least_squares-513"><a href="#get_lc_parameters_least_squares-513"><span class="linenos">513</span></a>
</span><span id="get_lc_parameters_least_squares-514"><a href="#get_lc_parameters_least_squares-514"><span class="linenos">514</span></a><span class="sd">    This helper uses `scipy.optimize.least_squares` to fit the MilkBot model with bounds,</span>
</span><span id="get_lc_parameters_least_squares-515"><a href="#get_lc_parameters_least_squares-515"><span class="linenos">515</span></a><span class="sd">    and returns the fitted parameters. </span>
</span><span id="get_lc_parameters_least_squares-516"><a href="#get_lc_parameters_least_squares-516"><span class="linenos">516</span></a><span class="sd">    Currently implemented only for the MilkBot model, as it is more complex and benefits from the robust optimization approach. </span>
</span><span id="get_lc_parameters_least_squares-517"><a href="#get_lc_parameters_least_squares-517"><span class="linenos">517</span></a><span class="sd">    Other models can be fitted using `get_lc_parameters` with numerical optimisation, which is generally faster for simpler models.</span>
</span><span id="get_lc_parameters_least_squares-518"><a href="#get_lc_parameters_least_squares-518"><span class="linenos">518</span></a>
</span><span id="get_lc_parameters_least_squares-519"><a href="#get_lc_parameters_least_squares-519"><span class="linenos">519</span></a><span class="sd">    Args:</span>
</span><span id="get_lc_parameters_least_squares-520"><a href="#get_lc_parameters_least_squares-520"><span class="linenos">520</span></a><span class="sd">        dim (int): List/array of DIM values.</span>
</span><span id="get_lc_parameters_least_squares-521"><a href="#get_lc_parameters_least_squares-521"><span class="linenos">521</span></a><span class="sd">        milkrecordings (float): List/array of milk recordings (kg).</span>
</span><span id="get_lc_parameters_least_squares-522"><a href="#get_lc_parameters_least_squares-522"><span class="linenos">522</span></a><span class="sd">        model (str): Pre-defined model name; currently used with &quot;milkbot&quot;.</span>
</span><span id="get_lc_parameters_least_squares-523"><a href="#get_lc_parameters_least_squares-523"><span class="linenos">523</span></a>
</span><span id="get_lc_parameters_least_squares-524"><a href="#get_lc_parameters_least_squares-524"><span class="linenos">524</span></a><span class="sd">    Returns:</span>
</span><span id="get_lc_parameters_least_squares-525"><a href="#get_lc_parameters_least_squares-525"><span class="linenos">525</span></a><span class="sd">        Parameters `(a, b, c, d)` as `np.float` in alphabetic order.</span>
</span><span id="get_lc_parameters_least_squares-526"><a href="#get_lc_parameters_least_squares-526"><span class="linenos">526</span></a>
</span><span id="get_lc_parameters_least_squares-527"><a href="#get_lc_parameters_least_squares-527"><span class="linenos">527</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_lc_parameters_least_squares-528"><a href="#get_lc_parameters_least_squares-528"><span class="linenos">528</span></a>    <span class="c1"># check and prepare input</span>
</span><span id="get_lc_parameters_least_squares-529"><a href="#get_lc_parameters_least_squares-529"><span class="linenos">529</span></a>    <span class="n">inputs</span> <span class="o">=</span> <span class="n">validate_and_prepare_inputs</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="get_lc_parameters_least_squares-530"><a href="#get_lc_parameters_least_squares-530"><span class="linenos">530</span></a>
</span><span id="get_lc_parameters_least_squares-531"><a href="#get_lc_parameters_least_squares-531"><span class="linenos">531</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">dim</span>
</span><span id="get_lc_parameters_least_squares-532"><a href="#get_lc_parameters_least_squares-532"><span class="linenos">532</span></a>    <span class="n">milkrecordings</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">milkrecordings</span>
</span><span id="get_lc_parameters_least_squares-533"><a href="#get_lc_parameters_least_squares-533"><span class="linenos">533</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">model</span>
</span><span id="get_lc_parameters_least_squares-534"><a href="#get_lc_parameters_least_squares-534"><span class="linenos">534</span></a>
</span><span id="get_lc_parameters_least_squares-535"><a href="#get_lc_parameters_least_squares-535"><span class="linenos">535</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-536"><a href="#get_lc_parameters_least_squares-536"><span class="linenos">536</span></a>    <span class="c1"># Initial guess</span>
</span><span id="get_lc_parameters_least_squares-537"><a href="#get_lc_parameters_least_squares-537"><span class="linenos">537</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-538"><a href="#get_lc_parameters_least_squares-538"><span class="linenos">538</span></a>    <span class="n">a0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">milkrecordings</span><span class="p">)</span>
</span><span id="get_lc_parameters_least_squares-539"><a href="#get_lc_parameters_least_squares-539"><span class="linenos">539</span></a>    <span class="n">b0</span> <span class="o">=</span> <span class="mf">50.0</span>
</span><span id="get_lc_parameters_least_squares-540"><a href="#get_lc_parameters_least_squares-540"><span class="linenos">540</span></a>    <span class="n">c0</span> <span class="o">=</span> <span class="mf">30.0</span>
</span><span id="get_lc_parameters_least_squares-541"><a href="#get_lc_parameters_least_squares-541"><span class="linenos">541</span></a>    <span class="n">d0</span> <span class="o">=</span> <span class="mf">0.01</span>
</span><span id="get_lc_parameters_least_squares-542"><a href="#get_lc_parameters_least_squares-542"><span class="linenos">542</span></a>    <span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">d0</span><span class="p">]</span>
</span><span id="get_lc_parameters_least_squares-543"><a href="#get_lc_parameters_least_squares-543"><span class="linenos">543</span></a>
</span><span id="get_lc_parameters_least_squares-544"><a href="#get_lc_parameters_least_squares-544"><span class="linenos">544</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-545"><a href="#get_lc_parameters_least_squares-545"><span class="linenos">545</span></a>    <span class="c1"># Parameter bounds</span>
</span><span id="get_lc_parameters_least_squares-546"><a href="#get_lc_parameters_least_squares-546"><span class="linenos">546</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-547"><a href="#get_lc_parameters_least_squares-547"><span class="linenos">547</span></a>    <span class="n">lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">milkrecordings</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">]</span>
</span><span id="get_lc_parameters_least_squares-548"><a href="#get_lc_parameters_least_squares-548"><span class="linenos">548</span></a>    <span class="n">upper</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">milkrecordings</span><span class="p">)</span> <span class="o">*</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
</span><span id="get_lc_parameters_least_squares-549"><a href="#get_lc_parameters_least_squares-549"><span class="linenos">549</span></a>
</span><span id="get_lc_parameters_least_squares-550"><a href="#get_lc_parameters_least_squares-550"><span class="linenos">550</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-551"><a href="#get_lc_parameters_least_squares-551"><span class="linenos">551</span></a>    <span class="c1"># Fit using least-squares</span>
</span><span id="get_lc_parameters_least_squares-552"><a href="#get_lc_parameters_least_squares-552"><span class="linenos">552</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-553"><a href="#get_lc_parameters_least_squares-553"><span class="linenos">553</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">least_squares</span><span class="p">(</span>
</span><span id="get_lc_parameters_least_squares-554"><a href="#get_lc_parameters_least_squares-554"><span class="linenos">554</span></a>        <span class="n">residuals_milkbot</span><span class="p">,</span>
</span><span id="get_lc_parameters_least_squares-555"><a href="#get_lc_parameters_least_squares-555"><span class="linenos">555</span></a>        <span class="n">p0</span><span class="p">,</span>
</span><span id="get_lc_parameters_least_squares-556"><a href="#get_lc_parameters_least_squares-556"><span class="linenos">556</span></a>        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">milkrecordings</span><span class="p">),</span>
</span><span id="get_lc_parameters_least_squares-557"><a href="#get_lc_parameters_least_squares-557"><span class="linenos">557</span></a>        <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">),</span>
</span><span id="get_lc_parameters_least_squares-558"><a href="#get_lc_parameters_least_squares-558"><span class="linenos">558</span></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;trf&quot;</span><span class="p">,</span>  <span class="c1"># trust region reflective, works well with bounds</span>
</span><span id="get_lc_parameters_least_squares-559"><a href="#get_lc_parameters_least_squares-559"><span class="linenos">559</span></a>    <span class="p">)</span>
</span><span id="get_lc_parameters_least_squares-560"><a href="#get_lc_parameters_least_squares-560"><span class="linenos">560</span></a>
</span><span id="get_lc_parameters_least_squares-561"><a href="#get_lc_parameters_least_squares-561"><span class="linenos">561</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-562"><a href="#get_lc_parameters_least_squares-562"><span class="linenos">562</span></a>    <span class="c1"># Extract parameters</span>
</span><span id="get_lc_parameters_least_squares-563"><a href="#get_lc_parameters_least_squares-563"><span class="linenos">563</span></a>    <span class="c1"># ------------------------------</span>
</span><span id="get_lc_parameters_least_squares-564"><a href="#get_lc_parameters_least_squares-564"><span class="linenos">564</span></a>    <span class="n">a_mb</span><span class="p">,</span> <span class="n">b_mb</span><span class="p">,</span> <span class="n">c_mb</span><span class="p">,</span> <span class="n">d_mb</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
</span><span id="get_lc_parameters_least_squares-565"><a href="#get_lc_parameters_least_squares-565"><span class="linenos">565</span></a>
</span><span id="get_lc_parameters_least_squares-566"><a href="#get_lc_parameters_least_squares-566"><span class="linenos">566</span></a>    <span class="k">return</span> <span class="n">a_mb</span><span class="p">,</span> <span class="n">b_mb</span><span class="p">,</span> <span class="n">c_mb</span><span class="p">,</span> <span class="n">d_mb</span>
</span></pre></div>


            <div class="docstring"><p>Fit lactation data and return model parameters (least squares; frequentist).</p>

<p>This helper uses <code>scipy.optimize.least_squares</code> to fit the MilkBot model with bounds,
and returns the fitted parameters. 
Currently implemented only for the MilkBot model, as it is more complex and benefits from the robust optimization approach. 
Other models can be fitted using <code><a href="#get_lc_parameters">get_lc_parameters</a></code> with numerical optimisation, which is generally faster for simpler models.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>dim (int):</strong>  List/array of DIM values.</li>
<li><strong>milkrecordings (float):</strong>  List/array of milk recordings (kg).</li>
<li><strong>model (str):</strong>  Pre-defined model name; currently used with "milkbot".</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Parameters <code>(a, b, c, d)</code> as <code>np.float</code> in alphabetic order.</p>
</blockquote>
</div>


                </section>
                <section id="hayashi_model">
                            <input id="hayashi_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hayashi_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hayashi_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hayashi_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hayashi_model-249"><a href="#hayashi_model-249"><span class="linenos">249</span></a><span class="k">def</span><span class="w"> </span><span class="nf">hayashi_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="hayashi_model-250"><a href="#hayashi_model-250"><span class="linenos">250</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Hayashi lactation curve model.</span>
</span><span id="hayashi_model-251"><a href="#hayashi_model-251"><span class="linenos">251</span></a>
</span><span id="hayashi_model-252"><a href="#hayashi_model-252"><span class="linenos">252</span></a><span class="sd">    Args:</span>
</span><span id="hayashi_model-253"><a href="#hayashi_model-253"><span class="linenos">253</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="hayashi_model-254"><a href="#hayashi_model-254"><span class="linenos">254</span></a><span class="sd">        a: Ratio parameter (&gt; 0) (numerical).</span>
</span><span id="hayashi_model-255"><a href="#hayashi_model-255"><span class="linenos">255</span></a><span class="sd">        b: Scale parameter (numerical).</span>
</span><span id="hayashi_model-256"><a href="#hayashi_model-256"><span class="linenos">256</span></a><span class="sd">        c: Time constant for the first exponential term (numerical).</span>
</span><span id="hayashi_model-257"><a href="#hayashi_model-257"><span class="linenos">257</span></a><span class="sd">        d: Parameter retained for compatibility with literature (unused in this expression).</span>
</span><span id="hayashi_model-258"><a href="#hayashi_model-258"><span class="linenos">258</span></a>
</span><span id="hayashi_model-259"><a href="#hayashi_model-259"><span class="linenos">259</span></a><span class="sd">    Returns:</span>
</span><span id="hayashi_model-260"><a href="#hayashi_model-260"><span class="linenos">260</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="hayashi_model-261"><a href="#hayashi_model-261"><span class="linenos">261</span></a>
</span><span id="hayashi_model-262"><a href="#hayashi_model-262"><span class="linenos">262</span></a><span class="sd">    Notes:</span>
</span><span id="hayashi_model-263"><a href="#hayashi_model-263"><span class="linenos">263</span></a><span class="sd">        Formula: `y(t) = b * (exp(-t / c) - exp(-t / (a * c)))`.</span>
</span><span id="hayashi_model-264"><a href="#hayashi_model-264"><span class="linenos">264</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="hayashi_model-265"><a href="#hayashi_model-265"><span class="linenos">265</span></a>    <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Hayashi lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Ratio parameter (&gt; 0) (numerical).</li>
<li><strong>b:</strong>  Scale parameter (numerical).</li>
<li><strong>c:</strong>  Time constant for the first exponential term (numerical).</li>
<li><strong>d:</strong>  Parameter retained for compatibility with literature (unused in this expression).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = b * (exp(-t / c) - exp(-t / (a * c)))</code>.</p>
</blockquote>
</div>


                </section>
                <section id="milkbot_model">
                            <input id="milkbot_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">milkbot_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="milkbot_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#milkbot_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="milkbot_model-71"><a href="#milkbot_model-71"><span class="linenos">71</span></a><span class="k">def</span><span class="w"> </span><span class="nf">milkbot_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="milkbot_model-72"><a href="#milkbot_model-72"><span class="linenos">72</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MilkBot lactation curve model.</span>
</span><span id="milkbot_model-73"><a href="#milkbot_model-73"><span class="linenos">73</span></a>
</span><span id="milkbot_model-74"><a href="#milkbot_model-74"><span class="linenos">74</span></a><span class="sd">    Args:</span>
</span><span id="milkbot_model-75"><a href="#milkbot_model-75"><span class="linenos">75</span></a><span class="sd">        t: Time since calving in days (DIM), scalar or array-like.</span>
</span><span id="milkbot_model-76"><a href="#milkbot_model-76"><span class="linenos">76</span></a><span class="sd">        a: Scale; overall level of milk production.</span>
</span><span id="milkbot_model-77"><a href="#milkbot_model-77"><span class="linenos">77</span></a><span class="sd">        b: Ramp; governs the rate of rise in early lactation.</span>
</span><span id="milkbot_model-78"><a href="#milkbot_model-78"><span class="linenos">78</span></a><span class="sd">        c: Offset; small (usually minor) correction around the theoretical start of lactation.</span>
</span><span id="milkbot_model-79"><a href="#milkbot_model-79"><span class="linenos">79</span></a><span class="sd">        d: Decay; exponential decline rate, evident in late lactation.</span>
</span><span id="milkbot_model-80"><a href="#milkbot_model-80"><span class="linenos">80</span></a>
</span><span id="milkbot_model-81"><a href="#milkbot_model-81"><span class="linenos">81</span></a><span class="sd">    Returns:</span>
</span><span id="milkbot_model-82"><a href="#milkbot_model-82"><span class="linenos">82</span></a><span class="sd">        Predicted milk yield at `t` (same shape as `t`).</span>
</span><span id="milkbot_model-83"><a href="#milkbot_model-83"><span class="linenos">83</span></a>
</span><span id="milkbot_model-84"><a href="#milkbot_model-84"><span class="linenos">84</span></a><span class="sd">    Notes:</span>
</span><span id="milkbot_model-85"><a href="#milkbot_model-85"><span class="linenos">85</span></a><span class="sd">        Formula: `y(t) = a * (1 - exp((c - t) / b) / 2) * exp(-d * t)`.</span>
</span><span id="milkbot_model-86"><a href="#milkbot_model-86"><span class="linenos">86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="milkbot_model-87"><a href="#milkbot_model-87"><span class="linenos">87</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">d</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>MilkBot lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM), scalar or array-like.</li>
<li><strong>a:</strong>  Scale; overall level of milk production.</li>
<li><strong>b:</strong>  Ramp; governs the rate of rise in early lactation.</li>
<li><strong>c:</strong>  Offset; small (usually minor) correction around the theoretical start of lactation.</li>
<li><strong>d:</strong>  Decay; exponential decline rate, evident in late lactation.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code> (same shape as <code>t</code>).</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a * (1 - exp((c - t) / b) / 2) * exp(-d * t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="nelder_model">
                            <input id="nelder_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nelder_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="nelder_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#nelder_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="nelder_model-194"><a href="#nelder_model-194"><span class="linenos">194</span></a><span class="k">def</span><span class="w"> </span><span class="nf">nelder_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="nelder_model-195"><a href="#nelder_model-195"><span class="linenos">195</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Nelder lactation curve model.</span>
</span><span id="nelder_model-196"><a href="#nelder_model-196"><span class="linenos">196</span></a>
</span><span id="nelder_model-197"><a href="#nelder_model-197"><span class="linenos">197</span></a><span class="sd">    Args:</span>
</span><span id="nelder_model-198"><a href="#nelder_model-198"><span class="linenos">198</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="nelder_model-199"><a href="#nelder_model-199"><span class="linenos">199</span></a><span class="sd">        a: Denominator intercept (numerical).</span>
</span><span id="nelder_model-200"><a href="#nelder_model-200"><span class="linenos">200</span></a><span class="sd">        b: Denominator linear coefficient (numerical).</span>
</span><span id="nelder_model-201"><a href="#nelder_model-201"><span class="linenos">201</span></a><span class="sd">        c: Denominator quadratic coefficient (numerical).</span>
</span><span id="nelder_model-202"><a href="#nelder_model-202"><span class="linenos">202</span></a>
</span><span id="nelder_model-203"><a href="#nelder_model-203"><span class="linenos">203</span></a><span class="sd">    Returns:</span>
</span><span id="nelder_model-204"><a href="#nelder_model-204"><span class="linenos">204</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="nelder_model-205"><a href="#nelder_model-205"><span class="linenos">205</span></a>
</span><span id="nelder_model-206"><a href="#nelder_model-206"><span class="linenos">206</span></a><span class="sd">    Notes:</span>
</span><span id="nelder_model-207"><a href="#nelder_model-207"><span class="linenos">207</span></a><span class="sd">        Formula: `y(t) = t / (a + b*t + c*t**2)`.</span>
</span><span id="nelder_model-208"><a href="#nelder_model-208"><span class="linenos">208</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="nelder_model-209"><a href="#nelder_model-209"><span class="linenos">209</span></a>    <span class="k">return</span> <span class="n">t</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Nelder lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Denominator intercept (numerical).</li>
<li><strong>b:</strong>  Denominator linear coefficient (numerical).</li>
<li><strong>c:</strong>  Denominator quadratic coefficient (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = t / (a + b*t + c*t**2)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="prasad_model">
                            <input id="prasad_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prasad_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="prasad_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#prasad_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="prasad_model-306"><a href="#prasad_model-306"><span class="linenos">306</span></a><span class="k">def</span><span class="w"> </span><span class="nf">prasad_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="prasad_model-307"><a href="#prasad_model-307"><span class="linenos">307</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prasad lactation curve model.</span>
</span><span id="prasad_model-308"><a href="#prasad_model-308"><span class="linenos">308</span></a>
</span><span id="prasad_model-309"><a href="#prasad_model-309"><span class="linenos">309</span></a><span class="sd">    Args:</span>
</span><span id="prasad_model-310"><a href="#prasad_model-310"><span class="linenos">310</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="prasad_model-311"><a href="#prasad_model-311"><span class="linenos">311</span></a><span class="sd">        a: Intercept-like parameter (numerical).</span>
</span><span id="prasad_model-312"><a href="#prasad_model-312"><span class="linenos">312</span></a><span class="sd">        b: Linear coefficient (numerical).</span>
</span><span id="prasad_model-313"><a href="#prasad_model-313"><span class="linenos">313</span></a><span class="sd">        c: Quadratic coefficient (numerical).</span>
</span><span id="prasad_model-314"><a href="#prasad_model-314"><span class="linenos">314</span></a><span class="sd">        d: Inverse-time coefficient (numerical).</span>
</span><span id="prasad_model-315"><a href="#prasad_model-315"><span class="linenos">315</span></a>
</span><span id="prasad_model-316"><a href="#prasad_model-316"><span class="linenos">316</span></a><span class="sd">    Returns:</span>
</span><span id="prasad_model-317"><a href="#prasad_model-317"><span class="linenos">317</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="prasad_model-318"><a href="#prasad_model-318"><span class="linenos">318</span></a>
</span><span id="prasad_model-319"><a href="#prasad_model-319"><span class="linenos">319</span></a><span class="sd">    Notes:</span>
</span><span id="prasad_model-320"><a href="#prasad_model-320"><span class="linenos">320</span></a><span class="sd">        Formula: `y(t) = a + b*t + c*t**2 + d/t`.</span>
</span><span id="prasad_model-321"><a href="#prasad_model-321"><span class="linenos">321</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="prasad_model-322"><a href="#prasad_model-322"><span class="linenos">322</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">/</span> <span class="n">t</span>
</span></pre></div>


            <div class="docstring"><p>Prasad lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Intercept-like parameter (numerical).</li>
<li><strong>b:</strong>  Linear coefficient (numerical).</li>
<li><strong>c:</strong>  Quadratic coefficient (numerical).</li>
<li><strong>d:</strong>  Inverse-time coefficient (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a + b*t + c*t**2 + d/t</code>.</p>
</blockquote>
</div>


                </section>
                <section id="rook_model">
                            <input id="rook_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rook_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">d</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="rook_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#rook_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="rook_model-268"><a href="#rook_model-268"><span class="linenos">268</span></a><span class="k">def</span><span class="w"> </span><span class="nf">rook_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span><span id="rook_model-269"><a href="#rook_model-269"><span class="linenos">269</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rook lactation curve model.</span>
</span><span id="rook_model-270"><a href="#rook_model-270"><span class="linenos">270</span></a>
</span><span id="rook_model-271"><a href="#rook_model-271"><span class="linenos">271</span></a><span class="sd">    Args:</span>
</span><span id="rook_model-272"><a href="#rook_model-272"><span class="linenos">272</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="rook_model-273"><a href="#rook_model-273"><span class="linenos">273</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="rook_model-274"><a href="#rook_model-274"><span class="linenos">274</span></a><span class="sd">        b: Shape parameter in rational term (numerical).</span>
</span><span id="rook_model-275"><a href="#rook_model-275"><span class="linenos">275</span></a><span class="sd">        c: Offset parameter in rational term (numerical).</span>
</span><span id="rook_model-276"><a href="#rook_model-276"><span class="linenos">276</span></a><span class="sd">        d: Exponential decay parameter (numerical).</span>
</span><span id="rook_model-277"><a href="#rook_model-277"><span class="linenos">277</span></a>
</span><span id="rook_model-278"><a href="#rook_model-278"><span class="linenos">278</span></a><span class="sd">    Returns:</span>
</span><span id="rook_model-279"><a href="#rook_model-279"><span class="linenos">279</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="rook_model-280"><a href="#rook_model-280"><span class="linenos">280</span></a>
</span><span id="rook_model-281"><a href="#rook_model-281"><span class="linenos">281</span></a><span class="sd">    Notes:</span>
</span><span id="rook_model-282"><a href="#rook_model-282"><span class="linenos">282</span></a><span class="sd">        Formula: `y(t) = a * (1 / (1 + b / (c + t))) * exp(-d * t)`.</span>
</span><span id="rook_model-283"><a href="#rook_model-283"><span class="linenos">283</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="rook_model-284"><a href="#rook_model-284"><span class="linenos">284</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">t</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">d</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Rook lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Shape parameter in rational term (numerical).</li>
<li><strong>c:</strong>  Offset parameter in rational term (numerical).</li>
<li><strong>d:</strong>  Exponential decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a * (1 / (1 + b / (c + t))) * exp(-d * t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="sikka_model">
                            <input id="sikka_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sikka_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sikka_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sikka_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sikka_model-179"><a href="#sikka_model-179"><span class="linenos">179</span></a><span class="k">def</span><span class="w"> </span><span class="nf">sikka_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="sikka_model-180"><a href="#sikka_model-180"><span class="linenos">180</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sikka lactation curve model.</span>
</span><span id="sikka_model-181"><a href="#sikka_model-181"><span class="linenos">181</span></a>
</span><span id="sikka_model-182"><a href="#sikka_model-182"><span class="linenos">182</span></a><span class="sd">    Args:</span>
</span><span id="sikka_model-183"><a href="#sikka_model-183"><span class="linenos">183</span></a><span class="sd">        t: Time since calving in days (DIM).</span>
</span><span id="sikka_model-184"><a href="#sikka_model-184"><span class="linenos">184</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="sikka_model-185"><a href="#sikka_model-185"><span class="linenos">185</span></a><span class="sd">        b: Growth parameter (numerical).</span>
</span><span id="sikka_model-186"><a href="#sikka_model-186"><span class="linenos">186</span></a><span class="sd">        c: Quadratic decay parameter (numerical).</span>
</span><span id="sikka_model-187"><a href="#sikka_model-187"><span class="linenos">187</span></a>
</span><span id="sikka_model-188"><a href="#sikka_model-188"><span class="linenos">188</span></a><span class="sd">    Returns:</span>
</span><span id="sikka_model-189"><a href="#sikka_model-189"><span class="linenos">189</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="sikka_model-190"><a href="#sikka_model-190"><span class="linenos">190</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sikka_model-191"><a href="#sikka_model-191"><span class="linenos">191</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sikka lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM).</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Growth parameter (numerical).</li>
<li><strong>c:</strong>  Quadratic decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>
</div>


                </section>
                <section id="wilmink_model">
                            <input id="wilmink_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">wilmink_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span>, </span><span class="param"><span class="n">k</span><span class="o">=-</span><span class="mf">0.05</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="wilmink_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#wilmink_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="wilmink_model-108"><a href="#wilmink_model-108"><span class="linenos">108</span></a><span class="k">def</span><span class="w"> </span><span class="nf">wilmink_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">):</span>
</span><span id="wilmink_model-109"><a href="#wilmink_model-109"><span class="linenos">109</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wilmink lactation curve model.</span>
</span><span id="wilmink_model-110"><a href="#wilmink_model-110"><span class="linenos">110</span></a>
</span><span id="wilmink_model-111"><a href="#wilmink_model-111"><span class="linenos">111</span></a><span class="sd">    Args:</span>
</span><span id="wilmink_model-112"><a href="#wilmink_model-112"><span class="linenos">112</span></a><span class="sd">        t: Time since calving in days (DIM), scalar or array-like.</span>
</span><span id="wilmink_model-113"><a href="#wilmink_model-113"><span class="linenos">113</span></a><span class="sd">        a: Intercept-like parameter (numerical).</span>
</span><span id="wilmink_model-114"><a href="#wilmink_model-114"><span class="linenos">114</span></a><span class="sd">        b: Linear trend coefficient (numerical).</span>
</span><span id="wilmink_model-115"><a href="#wilmink_model-115"><span class="linenos">115</span></a><span class="sd">        c: Exponential-term scale (numerical).</span>
</span><span id="wilmink_model-116"><a href="#wilmink_model-116"><span class="linenos">116</span></a><span class="sd">        k: Fixed exponential rate (numerical), default -0.05.</span>
</span><span id="wilmink_model-117"><a href="#wilmink_model-117"><span class="linenos">117</span></a>
</span><span id="wilmink_model-118"><a href="#wilmink_model-118"><span class="linenos">118</span></a><span class="sd">    Returns:</span>
</span><span id="wilmink_model-119"><a href="#wilmink_model-119"><span class="linenos">119</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="wilmink_model-120"><a href="#wilmink_model-120"><span class="linenos">120</span></a>
</span><span id="wilmink_model-121"><a href="#wilmink_model-121"><span class="linenos">121</span></a><span class="sd">    Notes:</span>
</span><span id="wilmink_model-122"><a href="#wilmink_model-122"><span class="linenos">122</span></a><span class="sd">        Formula: `y(t) = a + b * t + c * exp(k * t)`.</span>
</span><span id="wilmink_model-123"><a href="#wilmink_model-123"><span class="linenos">123</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="wilmink_model-124"><a href="#wilmink_model-124"><span class="linenos">124</span></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="wilmink_model-125"><a href="#wilmink_model-125"><span class="linenos">125</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Wilmink lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM), scalar or array-like.</li>
<li><strong>a:</strong>  Intercept-like parameter (numerical).</li>
<li><strong>b:</strong>  Linear trend coefficient (numerical).</li>
<li><strong>c:</strong>  Exponential-term scale (numerical).</li>
<li><strong>k:</strong>  Fixed exponential rate (numerical), default -0.05.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a + b * t + c * exp(k * t)</code>.</p>
</blockquote>
</div>


                </section>
                <section id="wood_model">
                            <input id="wood_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">wood_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">a</span>, </span><span class="param"><span class="n">b</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="wood_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#wood_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="wood_model-90"><a href="#wood_model-90"><span class="linenos"> 90</span></a><span class="k">def</span><span class="w"> </span><span class="nf">wood_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="wood_model-91"><a href="#wood_model-91"><span class="linenos"> 91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wood lactation curve model.</span>
</span><span id="wood_model-92"><a href="#wood_model-92"><span class="linenos"> 92</span></a>
</span><span id="wood_model-93"><a href="#wood_model-93"><span class="linenos"> 93</span></a><span class="sd">    Args:</span>
</span><span id="wood_model-94"><a href="#wood_model-94"><span class="linenos"> 94</span></a><span class="sd">        t: Time since calving in days (DIM), scalar or array-like.</span>
</span><span id="wood_model-95"><a href="#wood_model-95"><span class="linenos"> 95</span></a><span class="sd">        a: Scale parameter (numerical).</span>
</span><span id="wood_model-96"><a href="#wood_model-96"><span class="linenos"> 96</span></a><span class="sd">        b: Shape parameter controlling rise (numerical).</span>
</span><span id="wood_model-97"><a href="#wood_model-97"><span class="linenos"> 97</span></a><span class="sd">        c: Decay parameter (numerical).</span>
</span><span id="wood_model-98"><a href="#wood_model-98"><span class="linenos"> 98</span></a>
</span><span id="wood_model-99"><a href="#wood_model-99"><span class="linenos"> 99</span></a><span class="sd">    Returns:</span>
</span><span id="wood_model-100"><a href="#wood_model-100"><span class="linenos">100</span></a><span class="sd">        Predicted milk yield at `t`.</span>
</span><span id="wood_model-101"><a href="#wood_model-101"><span class="linenos">101</span></a>
</span><span id="wood_model-102"><a href="#wood_model-102"><span class="linenos">102</span></a><span class="sd">    Notes:</span>
</span><span id="wood_model-103"><a href="#wood_model-103"><span class="linenos">103</span></a><span class="sd">        Formula: `y(t) = a * t**b * exp(-c * t)`.</span>
</span><span id="wood_model-104"><a href="#wood_model-104"><span class="linenos">104</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="wood_model-105"><a href="#wood_model-105"><span class="linenos">105</span></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Wood lactation curve model.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>t:</strong>  Time since calving in days (DIM), scalar or array-like.</li>
<li><strong>a:</strong>  Scale parameter (numerical).</li>
<li><strong>b:</strong>  Shape parameter controlling rise (numerical).</li>
<li><strong>c:</strong>  Decay parameter (numerical).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Predicted milk yield at <code>t</code>.</p>
</blockquote>

<h6 id="notes">Notes:</h6>

<blockquote>
  <p>Formula: <code>y(t) = a * t**b * exp(-c * t)</code>.</p>
</blockquote>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>